<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://rlilyyy.github.io">
  <title>滨滨和泓泓</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Stay folish, Stay hungry">
<meta property="og:type" content="website">
<meta property="og:title" content="滨滨和泓泓">
<meta property="og:url" content="http://rlilyyy.github.io/index.html">
<meta property="og:site_name" content="滨滨和泓泓">
<meta property="og:description" content="Stay folish, Stay hungry">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="滨滨和泓泓">
<meta name="twitter:description" content="Stay folish, Stay hungry">
  
    <link rel="alternative" href="/atom.xml" title="滨滨和泓泓" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/main.css">
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="http://tva3.sinaimg.cn/crop.0.0.720.720.180/7049ef44jw8ewq4mjthssj20k00k0jt6.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Rlilyyy</a></h1>
		</hgroup>

		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">主页</a></li>
	        
				<li><a href="http://www.libinhong.com:5000/#/">福利</a></li>
	        
				<li><a href="http://www.libinhong.com:90/">听听音乐</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/Rlilyyy" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/u/1883893572?is_all=1" title="weibo">weibo</a>
		        
					<a class="mail" target="_blank" href="/532273622@qq.com" title="mail">mail</a>
		        
					<a class="twitter" target="_blank" href="https://twitter.com/binbinhehonhon" title="twitter">twitter</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">Rlilyyy</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="http://tva3.sinaimg.cn/crop.0.0.720.720.180/7049ef44jw8ewq4mjthssj20k00k0jt6.jpg" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">Rlilyyy</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="http://www.libinhong.com:5000/#/">福利</a></li>
		        
					<li><a href="http://www.libinhong.com:90/">听听音乐</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/Rlilyyy" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/u/1883893572?is_all=1" title="weibo">weibo</a>
			        
						<a class="mail" target="_blank" href="/532273622@qq.com" title="mail">mail</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/binbinhehonhon" title="twitter">twitter</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        
  
    <article id="post-svg-sprite-简介" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/24/svg-sprite-简介/">svg sprite 简介</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>&emsp;&emsp;首页的高速加载和渲染一直是前端开发者们津津乐道的事情，因此各种技术也应运而生。在 HTTP1.1 时代，为了减少请求的发送，加快首页加载，压缩和合并成了必不可少的技术，其中包括了 JavaScript 文件的压缩、混淆和合并，还有 CSS 文件的压缩和合并，最后还有一个是针对小图片的请求优化，也就是 <code>CSS Sprite</code>，也叫 <code>雪碧图</code> 或 <code>CSS 精灵</code>。其大概的思想就是将多个小图片按照一定的尺寸和位置排列好，然后合成一张图片，最后用户访问页面时，只要请求这一张合成图，而开发者利用 <code>background-position</code> 等属性控制显示合成图某个位置的图片，即可达到一张图片多个图标的效果，同时也将请求数量压缩为一个。当然，这次我们要说的并不是这个技术，而是与之运用思想类似的 <code>SVG Sprite</code>。</p>
<h1 id="SVG-Sprite"><a href="#SVG-Sprite" class="headerlink" title="SVG Sprite"></a>SVG Sprite</h1><p>&emsp;&emsp;<code>SVG Sprite</code> 使用 <code>&lt;symbol&gt;</code> 标签来定义一个图形模板对象，好处在于其可以重复利用，我们可以看一下 <a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/symbol" target="_blank" rel="external">MDN</a> 中对 <code>&lt;symbol&gt;</code> 的定义：</p>
<blockquote>
<p>symbol元素用来定义一个图形模板对象，它可以用一个<use></use>元素实例化。symbol元素对图形的作用是在同一文档中多次使用，添加结构和语义。结构丰富的文档可以更生动地呈现出来，类似讲演稿或盲文，从而提升了可访问性。注意，一个symbol元素本身是不呈现的。只有symbol元素的实例（亦即，一个引用了symbol的 <use></use>元素）才能呈现。</p>
</blockquote>
<p>&emsp;&emsp;可以看到，<code>&lt;symbol&gt;</code> 定义的图形并不会第一时间显示出来，只有使用了 <code>&lt;use&gt;</code> 标签进行实例化以后才会显现。<a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/use" target="_blank" rel="external">MDN</a> 中对其做出了如下定义：</p>
<blockquote>
<p>use元素在SVG文档内取得目标节点，并在别的地方复制它们。它的效果等同于这些节点被深克隆到一个不可见的DOM中，然后将其粘贴到use元素的位置，很像HTML5中的克隆模板元素。</p>
</blockquote>
<p>&emsp;&emsp;而要使用 <code>&lt;use&gt;</code> 来实例化一个 <code>svg图形模板对象</code>，则要使用其中的 <code>xlink:href</code> 属性，在我们处理好的 <code>&lt;symbol&gt;</code> 上都会带有一个 <code>id</code>，如下所示（伪代码）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">xmlns:xlink</span>=<span class="string">"http://www.w3.org/1999/xlink"</span> <span class="attr">style</span>=<span class="string">"position:absolute;width:0;height:0;visibility:hidden"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">defs</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">symbol</span> <span class="attr">id</span>=<span class="string">"icon1"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">symbol</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">symbol</span> <span class="attr">id</span>=<span class="string">"icon2"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">symbol</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">symbol</span> <span class="attr">id</span>=<span class="string">"icon3"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">symbol</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">defs</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div></pre></td></tr></table></figure>
<p>&emsp;&emsp;根据每一个 <code>&lt;symbol&gt;</code> 的 <code>id</code>，我们可以使用 <code>&lt;use&gt;</code> 根据这些 <code>id</code> 来使用 <code>svg</code>，如下所示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"icons"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#icon1"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#icon2"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#icon3"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>SVG Sprite</code> 的基本原理就是运用这些元素，相比较 <code>CSS Sprite</code>，<code>SVG Sprite</code> 显得更为友好，不用多余的例如 <code>background-position</code> 属性来控制位置。</p>
<h1 id="兼容性"><a href="#兼容性" class="headerlink" title="兼容性"></a>兼容性</h1><p>&emsp;&emsp;运用一个技术的前提都是其兼容性满足项目的最低要求，或者在不兼容的情况下有相对应的替代方案。在饿了么 Web 的兼容性要求为 PC 端 IE9+，安卓移动端 4.4+，IOS7+，具体可以看 ElemeFE 的 <a href="https://github.com/ElemeFE/style-guide/blob/master/compatibility-web.md" target="_blank" rel="external">style-guide</a>。下面是在 <a href="http://caniuse.com/#search=SVG" target="_blank" rel="external">caniuse</a> 上的结果：<br><img src="http://7xoehm.com1.z0.glb.clouddn.com/svg-%E5%85%BC%E5%AE%B9%E6%80%A7.jpeg" alt="SVG-兼容性"></p>
<p>&emsp;&emsp;可以看到兼容性在 PC 端上是完全没有问题的，而在移动端上也能支持，所以可以安心地用起来了。</p>
<h1 id="结合-Webpack-使用-SVG-Sprite"><a href="#结合-Webpack-使用-SVG-Sprite" class="headerlink" title="结合 Webpack 使用 SVG Sprite"></a>结合 Webpack 使用 <code>SVG Sprite</code></h1><p>&emsp;&emsp;我们使用 <code>Webpack</code> 来对多个分离的 SVG 文件进行自动化处理为合并好的多个 <code>&lt;symbol&gt;</code>，并插入到 <code>&lt;body&gt;</code> 顶部。首先我们要对 <code>webpack.config.js</code> 进行配置。</p>
<p>首先看一下基本的文件目录结构：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">├── LICENSE</div><div class="line">├── README.md</div><div class="line">├── css</div><div class="line">│   └── index.css</div><div class="line">├── dist</div><div class="line">│   ├── app.css</div><div class="line">│   ├── app.js</div><div class="line">│   └── index.html</div><div class="line">├── js</div><div class="line">│   └── index.js</div><div class="line">├── package.json</div><div class="line">├── static</div><div class="line">│   ├── analytics.svg</div><div class="line">│   ├── archives.svg</div><div class="line">│   ├── businessman.svg</div><div class="line">│   ├── businessmen.svg</div><div class="line">│   ├── certificate.svg</div><div class="line">│   ├── chat.svg</div><div class="line">│   └── contract.svg</div><div class="line">├── template</div><div class="line">│   └── index.html</div><div class="line">└── webpack.config.js</div></pre></td></tr></table></figure></p>
<p>webpack.config.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">'extract-text-webpack-plugin'</span>);</div><div class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> plugins = [</div><div class="line">  <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</div><div class="line">    <span class="attr">filename</span>: <span class="string">'./index.html'</span>,</div><div class="line">    <span class="attr">template</span>: <span class="string">'./template/index.html'</span></div><div class="line">  &#125;)</div><div class="line">];</div><div class="line"></div><div class="line">plugins.push(</div><div class="line">  <span class="keyword">new</span> ExtractTextPlugin(<span class="string">'[name].css'</span>)</div><div class="line">);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: &#123;</div><div class="line">    <span class="attr">app</span>: <span class="string">'./js/index.js'</span>,</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'./dist'</span>,</div><div class="line">    <span class="attr">publicPath</span>: <span class="string">'./'</span>,</div><div class="line">    <span class="comment">// filename: '[name].[chunkhash:6].js'</span></div><div class="line">    filename: <span class="string">'[name].js'</span></div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">resolve</span>: &#123;</div><div class="line">    <span class="attr">extensions</span>: [ <span class="string">''</span>, <span class="string">'.js'</span> ]</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">module</span>: &#123;</div><div class="line">    <span class="attr">loaders</span>: [</div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>, <span class="attr">loader</span>: <span class="string">'babel-loader'</span> &#125;,</div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">loader</span>: ExtractTextPlugin.extract(<span class="string">'style'</span>, <span class="string">'css'</span>) &#125;,</div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.svg$/</span>, <span class="attr">loaders</span>: [ <span class="string">'svg-sprite-loader'</span>, <span class="string">'svgo-loader?useConfig=svgoConfig'</span> ] &#125;,</div><div class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.(gif|png|jpg|ttf|woff2|woff|eot)$/</span>, <span class="attr">loader</span>: <span class="string">'url?limit=1000&amp;name=[path][name].[hash:6].[ext]'</span> &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line"></div><div class="line">  <span class="attr">svgoConfig</span>: &#123;</div><div class="line">    <span class="attr">plugins</span>: [</div><div class="line">      &#123; <span class="attr">removeTitle</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">convertColors</span>: &#123; <span class="attr">shorthex</span>: <span class="literal">true</span> &#125; &#125;,</div><div class="line">      &#123; <span class="attr">convertPathData</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">cleanupAttrs</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">removeComments</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">removeDesc</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">removeUselessDefs</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">removeEmptyAttrs</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">removeHiddenElems</span>: <span class="literal">true</span> &#125;,</div><div class="line">      &#123; <span class="attr">removeEmptyText</span>: <span class="literal">true</span> &#125;</div><div class="line">    ]</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">plugins</span>: plugins</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;可以看到，配置文件中使用了 <code>svg-sprite-loader</code> 和 <code>svgo-loader</code> 对 <code>svg</code> 文件进行处理，<code>svg-sprite-loader</code> 的作用就是将多个 <code>svg</code> 文件合并为一个 <code>&lt;svg&gt;</code> 元素。至于 <code>svgo-loader</code>，作用是将 <code>&lt;svg&gt;</code> 中一些无用的信息过滤去除，精简结构，详细配置可以自行查阅对应的文档说明，可以根据实际需求进行过滤。接下来将列出 <code>index.css</code>, <code>index.js</code>, <code>index.html</code> 的内容：</p>
<p>index.css<br><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">* &#123;</div><div class="line">  <span class="attribute">box-sizing</span>: border-box;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.icons</span> <span class="selector-tag">svg</span> &#123;</div><div class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>index.js<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> indexStyle <span class="keyword">from</span> <span class="string">'../css/index.css'</span>;</div><div class="line"><span class="keyword">import</span> analytics <span class="keyword">from</span> <span class="string">'../static/analytics.svg'</span></div><div class="line"><span class="keyword">import</span> archives <span class="keyword">from</span> <span class="string">'../static/archives.svg'</span></div><div class="line"><span class="keyword">import</span> businessman <span class="keyword">from</span> <span class="string">'../static/businessman.svg'</span></div><div class="line"><span class="keyword">import</span> businessmen <span class="keyword">from</span> <span class="string">'../static/businessmen.svg'</span></div><div class="line"><span class="keyword">import</span> certificate <span class="keyword">from</span> <span class="string">'../static/certificate.svg'</span></div><div class="line"><span class="keyword">import</span> chat <span class="keyword">from</span> <span class="string">'../static/chat.svg'</span></div><div class="line"><span class="keyword">import</span> contract <span class="keyword">from</span> <span class="string">'../static/contract.svg'</span></div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'demo complete'</span>);</div></pre></td></tr></table></figure></p>
<p>index.html<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>svg-sprites-demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"icons"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#analytics"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#archives"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#businessman"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#businessmen"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#certificate"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#chat"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">use</span> <span class="attr">xlink:href</span>=<span class="string">"#contract"</span>/&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>&emsp;&emsp;以上就是主要的一些配置和内容，如果需要完整的项目，可以到我的 <a href="https://github.com/Rlilyyy/svg-sprites-demo" target="_blank" rel="external">github</a> 下 clone 项目到你的本地进行构建。下面是构建后的网页效果和结构：</p>
<p><img src="http://7xoehm.com1.z0.glb.clouddn.com/%E6%95%88%E6%9E%9C.jpeg" alt="效果"></p>
<h1 id="优点-amp-缺点"><a href="#优点-amp-缺点" class="headerlink" title="优点 &amp; 缺点"></a>优点 &amp; 缺点</h1><p>优点：</p>
<ul>
<li>将多个请求压缩为无请求</li>
<li>svg 对比 image 其屏幕适应性更好，任何分辨率都能达到高清效果</li>
<li>svg 体积更小</li>
<li>每一个 <code>&lt;symbol&gt;</code> 都可以重复利用</li>
</ul>
<p>缺点：</p>
<ul>
<li>svg 不利于变动性大的图片，例如需要经常修改颜色</li>
<li>兼容性对于需要兼容 IE8- 的网站不好，需要对低版本浏览器有替代方案</li>
</ul>
<p>参考资料：</p>
<blockquote>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/SVG/Element/svg" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Web/SVG/Element/svg</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/symbol" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/symbol</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/defs" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/defs</a><br><a href="https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/use" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/use</a></p>
</blockquote>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/10/24/svg-sprite-简介/" class="archive-article-date">
  	<time datetime="2016-10-24T14:14:25.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-10-24</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/小技巧/">小技巧</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/SVG/">SVG</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-CSS-Level-4-中的新东西" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/10/02/CSS-Level-4-中的新东西/">CSS Selectors Level 4 中的新东西</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>以下所有示例在 <code>Safari Technology Preview</code> 使用最佳，<code>Chrome Canary</code> 有些都还没实现，可能是我使用的姿势不对……</p>
</blockquote>
<h1 id="Negation-pseudo-class——-not"><a href="#Negation-pseudo-class——-not" class="headerlink" title="Negation pseudo-class——:not()"></a>Negation pseudo-class——:not()</h1><blockquote>
<p><code>:not()</code> 用于将符合规则的元素剔除，将样式规则应用于其他元素上。在 CSS3 中已经有 <code>:not()</code>，不过在 CSS3 中只能使用简单的匹配规则，例如 <code>:not(p)</code> 用来选择不是 <code>&lt;p&gt;&lt;/p&gt;</code> 的元素。而在 CSS4 中，可以应用更复杂的匹配规则，但是同样地不允许嵌套使用，例如 <code>:not(:not(...))</code>。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.negation</span> &#123;</div><div class="line">  <span class="attribute">color</span>: black;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.negation</span> <span class="selector-class">.default</span><span class="selector-pseudo">:not(</span><span class="selector-attr">[data-red="no"]</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.negation</span> <span class="selector-class">.default</span> <span class="selector-tag">a</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.negation</span> <span class="selector-class">.default</span> <span class="selector-tag">a</span><span class="selector-pseudo">:not(</span><span class="selector-attr">[rel="green"]</span>, <span class="selector-attr">[rel="default"]</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: blue;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"negation"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"default"</span> <span class="attr">data-red</span>=<span class="string">"no"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com"</span> <span class="attr">rel</span>=<span class="string">"green"</span>&gt;</span>这里是绿色<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.ele.me"</span> <span class="attr">rel</span>=<span class="string">"default"</span>&gt;</span>这里也是绿色<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.sina.com"</span> <span class="attr">rel</span>=<span class="string">"blue"</span>&gt;</span>这里是蓝色<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"default"</span> <span class="attr">data-red</span>=<span class="string">"no"</span>&gt;</span></div><div class="line">    这里是黑色</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"default"</span> <span class="attr">data-red</span>=<span class="string">"yes"</span>&gt;</span></div><div class="line">    这里是红色</div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="not-tips"><a href="#not-tips" class="headerlink" title=":not() tips"></a><code>:not()</code> tips</h2><p>我们可以利用 <code>:not()</code> 来对 CSS 样式进行一个优先级提升，例如 <code>div:not(span) {…}</code> 跟 <code>div {…}</code> 是同个概念，但是明显地前者的优先级更高。</p>
<blockquote>
<p>想解锁更多 <code>:not()</code> 的使用姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#negation" target="_blank" rel="external">The Negation Pseudo-class 草案</a>。</p>
</blockquote>
<h1 id="Matches-any-Pseudo-class——-matches-伪类"><a href="#Matches-any-Pseudo-class——-matches-伪类" class="headerlink" title="Matches-any Pseudo-class——:matches 伪类"></a>Matches-any Pseudo-class——:matches 伪类</h1><blockquote>
<p><code>:matches()</code> 用于匹配所述规则的元素，并应用相应的样式规则，同样不允许嵌套使用，<code>-webkit-any()</code> 和 <code>-moz-any()</code> 是它的两个兼容性写法。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.matches</span> &#123;</div><div class="line">  <span class="attribute">color</span>: black;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.matches</span> <span class="selector-pseudo">:matches(span</span>, <span class="selector-tag">div</span>) <span class="selector-pseudo">:matches(span</span>, <span class="selector-tag">div</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line">等同于</div><div class="line">.matches span div,</div><div class="line">.matches span span,</div><div class="line">.matches div span,</div><div class="line">.matches div div &#123;</div><div class="line">  color: green;</div><div class="line">&#125;</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="selector-class">.matches</span> <span class="selector-pseudo">:-webkit-any(span</span>, <span class="selector-tag">div</span>) <span class="selector-pseudo">:-webkit-any(span</span>, <span class="selector-tag">div</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.matches</span> <span class="selector-pseudo">:-moz-any(span</span>, <span class="selector-tag">div</span>) <span class="selector-pseudo">:-moz-any(span</span>, <span class="selector-tag">div</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.matches</span> <span class="selector-pseudo">:matches(.a</span>, <span class="selector-class">.b</span>) <span class="selector-pseudo">:matches(.a</span>, <span class="selector-class">.b</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line">等同于</div><div class="line">.matches .a .a,</div><div class="line">.matches .a .b,</div><div class="line">.matches .b .a,</div><div class="line">.matches .b .b &#123;</div><div class="line">  color: red;</div><div class="line">&#125;</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="selector-class">.matches</span> <span class="selector-pseudo">:-webkit-any(.a</span>, <span class="selector-class">.b</span>) <span class="selector-pseudo">:-webkit-any(.a</span>, <span class="selector-class">.b</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.matches</span> <span class="selector-pseudo">:-moz-any(.a</span>, <span class="selector-class">.b</span>) <span class="selector-pseudo">:-moz-any(.a</span>, <span class="selector-class">.b</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"matches"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>绿色<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>绿色<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>绿色<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>绿色<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"a"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"b"</span>&gt;</span>红色<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"b"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"a"</span>&gt;</span>红色<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"a"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"a"</span>&gt;</span>红色<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"b"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"b"</span>&gt;</span>红色<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#matches" target="_blank" rel="external">The Matches-any Pseudo-class 草案</a></p>
</blockquote>
<h1 id="Case-Sensitivity——不区分大小写匹配标识"><a href="#Case-Sensitivity——不区分大小写匹配标识" class="headerlink" title="Case-Sensitivity——不区分大小写匹配标识"></a>Case-Sensitivity——不区分大小写匹配标识</h1><blockquote>
<p><code>Case-Sensitivity</code> 用于声明某个匹配规则中，对字符串或者某个 value 的匹配不区分大小写。该标志声明于 <code>]</code> 即右中括号之前，例如 <code>[data-value=&quot;case&quot; i]</code>，其中的 <code>i</code> 就是 Case-Sensitivity 标识。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.case-sensitivity</span> <span class="selector-pseudo">:matches(</span><span class="selector-attr">[data-value="case" i]</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: yellow;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"case-sensitivity"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">data-value</span>=<span class="string">'Case'</span>&gt;</span>Case<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">data-value</span>=<span class="string">"case"</span>&gt;</span>case<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>以上的例子，<code>data-value</code> 虽然既有大写也有小写，但是由于我们声明了 <code>Case-Sensitivity</code>，所以无论大小写都会被匹配。像例子中 <code>case</code>，<code>Case</code>，<code>CASE</code> 等都会被匹配。</p>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#attribute-case" target="_blank" rel="external">Case-sensitivity 草案</a></p>
</blockquote>
<h1 id="The-Directionality-Pseudo-class——-dir"><a href="#The-Directionality-Pseudo-class——-dir" class="headerlink" title="The Directionality Pseudo-class——:dir()"></a>The Directionality Pseudo-class——:dir()</h1><blockquote>
<p><code>:dir()</code> 伪类用于匹配符合某个方向性的元素，例如 <code>:dir(ltr)</code> 和 <code>dir(rtl)</code>。顾名思义，<code>ltr</code> 表示 <code>left to right</code>，即方向从左到右，<code>rtl</code> 表示 <code>right-to-left</code>，即方向从右到左。值得注意的是，使用 <code>:dir()</code> 匹配元素和使用 <code>[dir=...]</code> 在某个程度上是一样的效果，但是一个区别是 <code>[dir=...]</code> 无法匹配到没有显示声明 <code>dir</code> 的元素，但是 <code>:dir()</code> 却可以匹配到由浏览器计算得到或者继承来的 <code>dir</code> 属性的元素，详情可以看一下<a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#dir-pseudo" target="_blank" rel="external">草案</a>。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.dir</span> <span class="selector-pseudo">:dir(ltr)</span> &#123;</div><div class="line">  <span class="attribute">color</span>: blue;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.dir</span> <span class="selector-pseudo">:dir(rtl)</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"dir"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">dir</span>=<span class="string">"ltr"</span>&gt;</span>从左到右<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">dir</span>=<span class="string">"rtl"</span>&gt;</span>从右到左<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#dir-pseudo" target="_blank" rel="external">The Directionality Pseudo-class 草案</a></p>
</blockquote>
<h1 id="The-Language-Pseudo-class——-lang"><a href="#The-Language-Pseudo-class——-lang" class="headerlink" title="The Language Pseudo-class——:lang()"></a>The Language Pseudo-class——:lang()</h1><blockquote>
<p><code>:lang()</code> 用于匹配声明了 <code>lang=value</code> 的元素，并且可以使用通配符匹配，例如 <code>p:lang(*-CH)</code> 将可以匹配 <code>de-CH</code> 的 <code>p</code> 元素。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.lang</span> <span class="selector-tag">p</span><span class="selector-pseudo">:lang(de-DE)</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.lang</span> <span class="selector-tag">p</span><span class="selector-pseudo">:lang(</span>*<span class="selector-tag">-CH</span>) &#123;</div><div class="line">  <span class="attribute">color</span>: blue;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"lang"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">lang</span>=<span class="string">"de-DE-1996"</span>&gt;</span>de-DE-1996<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">lang</span>=<span class="string">"de-CH"</span>&gt;</span>de-CH<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#lang-pseudo" target="_blank" rel="external">The language pseudo-class 草案</a></p>
</blockquote>
<h1 id="The-Hyperlink-Pseudo-class——-any-link-伪类"><a href="#The-Hyperlink-Pseudo-class——-any-link-伪类" class="headerlink" title="The Hyperlink Pseudo-class——:any-link 伪类"></a>The Hyperlink Pseudo-class——:any-link 伪类</h1><blockquote>
<p><code>:any-link</code> 用于匹配带有 <code>href</code> 属性的超链接元素，例如 <code>&lt;a&gt;</code>，<code>&lt;area&gt;</code>，<code>&lt;link&gt;</code> 等带有 <code>href</code> 属性的元素。<code>:-webkit-any-link</code> 和 <code>:-moz-any-link</code> 是它的兼容性写法。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.link</span> <span class="selector-tag">a</span><span class="selector-pseudo">:any-link</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.link</span> <span class="selector-tag">a</span><span class="selector-pseudo">:-webkit-any-link</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.link</span> <span class="selector-tag">a</span><span class="selector-pseudo">:-moz-any-link</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"link"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是带有颜色的超链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#the-any-link-pseudo" target="_blank" rel="external">The Hyperlink Pseudo-class 草案</a></p>
</blockquote>
<h1 id="The-contextual-reference-element-pseudo-class——-scope"><a href="#The-contextual-reference-element-pseudo-class——-scope" class="headerlink" title="The contextual reference element pseudo-class——:scope"></a>The contextual reference element pseudo-class——:scope</h1><blockquote>
<p><code>:scope</code> 用于匹配当前作用域下的顶级元素。但是目前 <code>&lt;style scoped&gt;</code> 已经被移除——<a href="https://github.com/whatwg/html/issues/552" target="_blank" rel="external">issue</a></p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"scope"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>This paragraph is outside the scope.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="css"></span></div><div class="line">      <span class="selector-pseudo">:scope</span> &#123;</div><div class="line">        <span class="attribute">background-color</span>: red;</div><div class="line">      &#125;</div><div class="line">      <span class="selector-tag">p</span> &#123;</div><div class="line">        <span class="attribute">color</span>: blue;</div><div class="line">      &#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This paragraph is inside the scope.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>以上代码，第二个 <code>div</code> 将会有红色背景，并且他的所有 <code>&lt;p&gt;</code> 子元素都将拥有蓝色文字。</p>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#the-scope-pseudo" target="_blank" rel="external">The contextual reference element pseudo-class 草案</a></p>
</blockquote>
<h1 id="Time-dimensional-Pseudo-classes——-current-past-future"><a href="#Time-dimensional-Pseudo-classes——-current-past-future" class="headerlink" title="Time-dimensional Pseudo-classes——:current(), :past(), :future()"></a>Time-dimensional Pseudo-classes——:current(), :past(), :future()</h1><blockquote>
<p>我个人用 <code>时间轴伪类</code> 统一称呼 <code>:current()</code>, <code>:past()</code>, <code>:future()</code> 这三个伪类。<code>:current()</code> 匹配时间轴当前的元素，<code>:past()</code> 匹配 <code>:current()</code>元素之前的元素，<code>:future()</code> 则匹配当前时间轴后的所有元素。这里说的时间轴指的是例如 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Video_Text_Tracks_Format" target="_blank" rel="external"><code>WebVTT</code></a>。值得注意的是，规范中写道如果使用的时间轴并不是文档语言所规定的，那么 <code>:past()</code> 和 <code>:future()</code> 有可能分别匹配 <code>:current()</code> 元素的前面的兄弟元素和后面的兄弟元素。由于在 Chrome Canary 和 Safari TP 上都不支持这几个伪类，所以无法实验正确性。下面使用的例子是从<a href="http://css4-selectors.com/selector/css4/time-dimensional-pseudo-class/" target="_blank" rel="external">这个网址</a>摘过来的。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="selector-pseudo">:current(p</span>, <span class="selector-tag">span</span>) &#123;</div><div class="line">  <span class="attribute">background-color</span>: yellow;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-pseudo">:past(p</span>, <span class="selector-tag">span</span>),</div><div class="line"><span class="selector-pseudo">:future(p</span>, <span class="selector-tag">span</span>) &#123;</div><div class="line">  <span class="attribute">background-color</span>: gray;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">controls</span> <span class="attr">preload</span>=<span class="string">"metadata"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"http://html5demos.com/assets/dizzy.mp4"</span> <span class="attr">type</span>=<span class="string">"video/mp4"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"http://html5demos.com/assets/dizzy.webm"</span> <span class="attr">type</span>=<span class="string">"video/webm"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">"http://html5demos.com/assets/dizzy.ogv"</span> <span class="attr">type</span>=<span class="string">"video/ogv"</span> /&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">track</span> <span class="attr">label</span>=<span class="string">"English"</span> <span class="attr">kind</span>=<span class="string">"subtitles"</span> <span class="attr">srclang</span>=<span class="string">"en"</span> <span class="attr">src</span>=<span class="string">"http://www.iandevlin.com/html5test/webvtt/upc-video-subtitles-en.vtt"</span> <span class="attr">default</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#time-pseudos" target="_blank" rel="external">Time-dimensional Pseudo-classes 草案</a></p>
</blockquote>
<h1 id="The-Indeterminate-value-Pseudo-class——-indeterminate"><a href="#The-Indeterminate-value-Pseudo-class——-indeterminate" class="headerlink" title="The Indeterminate-value Pseudo-class——:indeterminate"></a>The Indeterminate-value Pseudo-class——:indeterminate</h1><blockquote>
<p>在 <code>radio</code> 和 <code>checkbox</code> 元素上一般有两种状态——<code>选中</code> 和 <code>未选中</code>，但是有的时候的状态会是不确定状态，而 <code>:indeterminate</code> 就是匹配这种不确定状态的 <code>radio</code> 或 <code>checkbox</code>。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-pseudo">:indeterminate</span> + <span class="selector-tag">label</span> &#123;</div><div class="line">  <span class="attribute">background-color</span>: gray;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"test"</span>&gt;</span>未确定状态<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div></pre></td></tr></table></figure>
<p>上面例子的 <code>&lt;label&gt;</code> 在 <code>&lt;input&gt;</code> 处于 <code>indeterminate state</code> 的时候，文字将会变为灰色。</p>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#indeterminate" target="_blank" rel="external">The Indeterminate-value Pseudo-class 草案</a></p>
</blockquote>
<h1 id="The-default-option-pseudo-class——-default"><a href="#The-default-option-pseudo-class——-default" class="headerlink" title="The default-option pseudo-class——:default"></a>The default-option pseudo-class——:default</h1><blockquote>
<p><code>:default</code> 匹配一组相似元素集合中的默认元素，例如 <code>&lt;form&gt;</code> 中有多个 <code>&lt;input&gt;</code>，其中有一个是 <code>&lt;input type=&quot;submit&quot;&gt;</code>，那么该元素将会被匹配。此外还有 <code>&lt;option&gt;</code> 也有默认元素。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.default</span> <span class="selector-class">.default-form</span> <span class="selector-pseudo">:default</span> &#123;</div><div class="line">  <span class="attribute">background-color</span>: gray;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"default"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"default-form"</span> <span class="attr">action</span>=<span class="string">"#"</span> <span class="attr">method</span>=<span class="string">"get"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"submit"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"reset"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"reset"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#the-default-pseudo" target="_blank" rel="external">The default-option pseudo-class 草案</a></p>
</blockquote>
<h1 id="The-validity-pseudo-classes——-valid-invalid"><a href="#The-validity-pseudo-classes——-valid-invalid" class="headerlink" title="The validity pseudo-classes——:valid, :invalid"></a>The validity pseudo-classes——:valid, :invalid</h1><blockquote>
<p>在 <code>&lt;input type=&quot;email&quot;&gt;</code> 中，如果我们输入了 <code>abc123</code>，那么此时 <code>:invalid</code> 将会匹配该元素，假如我们输入 <code>abc123@163.com</code>，那么此时 <code>:valid</code> 将会匹配该元素。这里要注意假如我们没有为 <code>&lt;input&gt;</code> 作约束，例如 <code>&lt;input type=&quot;text&quot;&gt;</code>，那么它的任意输入将使元素既不会被 <code>:valid</code> 匹配，也不会被 <code>:invalid</code> 匹配。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.valid</span> <span class="selector-tag">input</span><span class="selector-pseudo">:valid</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.valid</span> <span class="selector-tag">input</span><span class="selector-pseudo">:invalid</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"valid"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"eamil_valid"</span> <span class="attr">value</span>=<span class="string">"abc@abc.com"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"email_invalid"</span> <span class="attr">value</span>=<span class="string">"abc"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#validity-pseudos" target="_blank" rel="external">The validity pseudo-classes 草案</a></p>
</blockquote>
<h1 id="The-range-pseudo-classes——-in-range-out-of-range"><a href="#The-range-pseudo-classes——-in-range-out-of-range" class="headerlink" title="The range pseudo-classes——:in-range, :out-of-range"></a>The range pseudo-classes——:in-range, :out-of-range</h1><blockquote>
<p><code>:in-range</code> 和 <code>:out-of-range</code> 只对有被条件约束的元素起作用，例如 <code>&lt;input type=&quot;number&quot; min=&quot;1&quot; value=&quot;1&quot;&gt;</code>，如果输入数字小于 1，那么将会被 <code>:out-of-range</code> 匹配，反之则是被 <code>:in-range</code> 匹配。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.range</span> <span class="selector-tag">input</span><span class="selector-pseudo">:in-range</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.range</span> <span class="selector-tag">input</span><span class="selector-pseudo">:out-of-range</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"range"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">name</span>=<span class="string">"range"</span> <span class="attr">value</span>=<span class="string">"1"</span> <span class="attr">min</span>=<span class="string">"1"</span> <span class="attr">max</span>=<span class="string">"10"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#range-pseudos" target="_blank" rel="external">The range pseudo-classes 草案</a></p>
</blockquote>
<h1 id="The-optionality-pseudo-classes——-required-optional"><a href="#The-optionality-pseudo-classes——-required-optional" class="headerlink" title="The optionality pseudo-classes——:required, :optional"></a>The optionality pseudo-classes——:required, :optional</h1><blockquote>
<p><code>:required</code> 和 <code>:optional</code> 分别匹配带有 <code>required</code> 标识的元素和不带 <code>required</code> 标识的元素。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.optionality</span> <span class="selector-tag">input</span><span class="selector-pseudo">:required</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.optionality</span> <span class="selector-tag">input</span><span class="selector-pseudo">:optional</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"optionality"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"required"</span> <span class="attr">value</span>=<span class="string">"required"</span> <span class="attr">required</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"optional"</span> <span class="attr">value</span>=<span class="string">"optional"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#opt-pseudos" target="_blank" rel="external">The optionality pseudo-classes 草案</a></p>
</blockquote>
<h1 id="The-user-interaction-pseudo-class——-user-error"><a href="#The-user-interaction-pseudo-class——-user-error" class="headerlink" title="The user-interaction pseudo-class——:user-error"></a>The user-interaction pseudo-class——:user-error</h1><blockquote>
<p><code>:user-error</code> 会匹配 <code>:invalid</code>, <code>:out-of-range</code> 和没有任何值的 <code>:required</code> 元素，但是假如是初始化时就触发这三种错误，<code>user-error</code> 将不会匹配该元素，只有当用户和元素进行交互或者提交了该表单并且触发了这三种错误，<code>:user-error</code> 才会被触发。Chrome 和 Safari 可能尚未支持（也可能是我使用姿势不对，希望指正），所以无法验证正确性。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.user-error</span> <span class="selector-tag">input</span><span class="selector-pseudo">:user-error</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.user-error</span> <span class="selector-tag">input</span><span class="selector-pseudo">:valid</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"user-error"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"eamil_valid"</span> <span class="attr">value</span>=<span class="string">"abc@abc.com"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"email_invalid"</span> <span class="attr">value</span>=<span class="string">"abc"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#user-pseudos" target="_blank" rel="external">The user-interaction pseudo-class 草案</a></p>
</blockquote>
<h1 id="The-mutability-pseudo-classes——-read-only-read-write"><a href="#The-mutability-pseudo-classes——-read-only-read-write" class="headerlink" title="The mutability pseudo-classes——:read-only, :read-write"></a>The mutability pseudo-classes——:read-only, :read-write</h1><blockquote>
<p><code>:read-only</code> 匹配不可被编辑的元素，<code>:read-write</code> 则匹配可被编辑的元素，例如 <code>&lt;input&gt;</code> 或者 <code>contenteditable=&quot;true&quot;</code> 的元素。<code>:-moz-read-only</code> 和 <code>:-moz-read-write</code> 分别是他们的兼容性写法。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.mutability</span> <span class="selector-pseudo">:read-only</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.mutability</span> <span class="selector-pseudo">:read-write</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"mutability"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"read-write-input"</span> <span class="attr">value</span>=<span class="string">"read-write"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">contenteditable</span>=<span class="string">"true"</span>&gt;</span>read-write-paragraph<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>read-only-paragraph<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#rw-pseudos" target="_blank" rel="external">The mutability pseudo-classes 草案</a></p>
</blockquote>
<h1 id="The-placeholder-shown-pseudo-class——-placeholder-shown"><a href="#The-placeholder-shown-pseudo-class——-placeholder-shown" class="headerlink" title="The placeholder-shown pseudo-class——:placeholder-shown"></a>The placeholder-shown pseudo-class——:placeholder-shown</h1><blockquote>
<p><code>:placeholder-shown</code> 匹配 <code>placeholder</code> 文字显示时的 <code>&lt;input&gt;</code> 元素。<code>::-webkit-input-placeholder</code>, <code>::-moz-placeholder</code>, <code>:-ms-input-placeholder</code> 分别是它在不同浏览器的兼容性写法。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.placeholder</span> <span class="selector-tag">input</span><span class="selector-pseudo">:placeholder-shown</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.placeholder</span> <span class="selector-tag">input</span><span class="selector-pseudo">::-webkit-input-placeholder</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.placeholder</span> <span class="selector-tag">input</span><span class="selector-pseudo">::-moz-placeholder</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.placeholder</span> <span class="selector-tag">input</span><span class="selector-pseudo">:-ms-input-placeholder</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"placeholder"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"placeholder"</span> <span class="attr">placeholder</span>=<span class="string">"placeholder is green"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#placeholder" target="_blank" rel="external">The placeholder-shown pseudo-class 草案</a></p>
</blockquote>
<h1 id="Grid-Structural-Selectors"><a href="#Grid-Structural-Selectors" class="headerlink" title="Grid-Structural Selectors"></a>Grid-Structural Selectors</h1><blockquote>
<p>该特性将对例如 <code>&lt;table&gt;</code> 的栅格布局起作用。它包含 <code>:column(selector)</code>, <code>:nth-column(n)</code> 和 <code>:nth-last-column(n)</code>。目前浏览器都还未支持，无法实验正确性。</p>
</blockquote>
<h2 id="column-selector"><a href="#column-selector" class="headerlink" title=":column(selector)"></a>:column(selector)</h2><blockquote>
<p><code>:column(selector)</code> 将匹配例如 <code>&lt;table&gt;</code> 中 带有 <code>selector</code> 类名的那一列的所有元素。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="selector-pseudo">:column(.selected)</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">col</span> <span class="attr">class</span>=<span class="string">"selected"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">col</span> <span class="attr">class</span>=<span class="string">"blur"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">col</span> <span class="attr">class</span>=<span class="string">"blur"</span> /&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>A<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>B<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>C<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>D<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>E<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>F<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>G<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>H<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>I<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div></pre></td></tr></table></figure>
<p>在上面的例子中，A、D、G 都将是绿色的。</p>
<h2 id="nth-column-n-和-nth-last-column-n"><a href="#nth-column-n-和-nth-last-column-n" class="headerlink" title=":nth-column(n) 和 :nth-last-column(n)"></a>:nth-column(n) 和 :nth-last-column(n)</h2><blockquote>
<p><code>:nth-column(n)</code> 匹配括号内 <code>n</code> 的计算值的某一列的元素，计算方式是从头开始计算，而 <code>:nth-last-column(n)</code> 则是从后开始计算。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="selector-pseudo">:nth-column(2n)</span> &#123;</div><div class="line">  <span class="attribute">color</span>: red;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-pseudo">:nth-last-column(3n)</span> &#123;</div><div class="line">  <span class="attribute">color</span>: green;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">col</span> <span class="attr">class</span>=<span class="string">"selected"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">col</span> <span class="attr">class</span>=<span class="string">"blur"</span> /&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">col</span> <span class="attr">class</span>=<span class="string">"blur"</span> /&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>A<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>B<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>C<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>D<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>E<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>F<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>G<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>H<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>I<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#table-pseudos" target="_blank" rel="external">Grid-Structural Selectors 草案</a></p>
</blockquote>
<h1 id="Tree-Structural-pseudo-classes——-blank"><a href="#Tree-Structural-pseudo-classes——-blank" class="headerlink" title="Tree-Structural pseudo-classes——:blank"></a>Tree-Structural pseudo-classes——:blank</h1><blockquote>
<p>Tree-Structural pseudo-classes 是 CSS3 中的规范，但在 CSS Selectors Level 4 中加入了 <code>:blank</code>，它和 <code>:empty</code> 类似，区别在于 <code>:empty</code> 只能匹配没有任何内容的元素，而 <code>:blank</code> 可以匹配带有 <code>spaces（空格）</code>, <code>tabs（缩进符）</code> and <code>segment breaks（段落过段）</code> 内容的元素。</p>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#blank-pseudo" target="_blank" rel="external">:blank pseudo-class 草案</a></p>
</blockquote>
<h1 id="Combinators——-gt-gt"><a href="#Combinators——-gt-gt" class="headerlink" title="Combinators——&gt;&gt;"></a>Combinators——<code>&gt;&gt;</code></h1><blockquote>
<p><code>A &gt;&gt; B</code> 匹配祖先元素为 A 的 B元素，其用法与 <code>A B</code> 一样，与 <code>&gt;</code>, <code>+</code>, <code>~</code> 用意一样，不过意义不同。</p>
<p>想解锁更多姿势就去看 <a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/#combinators" target="_blank" rel="external">Combinators 草案</a></p>
</blockquote>
<hr>
<blockquote>
<p>上面的特性都已经存在 Working Draft 中，还有一些 Editor’s Draft 的特性，也顺带一提。</p>
</blockquote>
<h1 id="The-Relational-Pseudo-class——-has"><a href="#The-Relational-Pseudo-class——-has" class="headerlink" title="The Relational Pseudo-class——:has()"></a>The Relational Pseudo-class——:has()</h1><blockquote>
<p><code>:has(selector)</code> 匹配含有 <code>某些规则</code> 的元素。</p>
</blockquote>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 将匹配含有 img 子元素的 a 元素 */</span></div><div class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:has(</span>&gt; <span class="selector-tag">img</span>)</div><div class="line"></div><div class="line"><span class="comment">/* 将匹配拥有 dt 兄弟元素的 dt 元素 */</span></div><div class="line"><span class="selector-tag">dt</span><span class="selector-pseudo">:has(+</span> <span class="selector-tag">dt</span>)</div><div class="line"></div><div class="line"><span class="comment">/* 将匹配不含有 h1、h2、h3、h4、h5、h6 元素的 section 元素 */</span></div><div class="line"><span class="selector-tag">section</span><span class="selector-pseudo">:not(</span><span class="selector-pseudo">:has(h1</span>, <span class="selector-tag">h2</span>, <span class="selector-tag">h3</span>, <span class="selector-tag">h4</span>, <span class="selector-tag">h5</span>, <span class="selector-tag">h6</span>))</div><div class="line"></div><div class="line"><span class="comment">/* 和上面例子不同，下面交换了两个伪类的嵌套，表示匹配含有的不是 h1、h2、h3、h4、h5、h6 子元素的元素，区别在于这种写法要求必须含有一个子元素，而上面的写法可以不含有子元素也会被匹配 */</span></div><div class="line"><span class="selector-tag">section</span><span class="selector-pseudo">:has(</span><span class="selector-pseudo">:not(h1</span>, <span class="selector-tag">h2</span>, <span class="selector-tag">h3</span>, <span class="selector-tag">h4</span>, <span class="selector-tag">h5</span>, <span class="selector-tag">h6</span>))</div></pre></td></tr></table></figure>
<blockquote>
<p>想解锁更多姿势就去看 <a href="https://drafts.csswg.org/selectors-4/#has-pseudo" target="_blank" rel="external">The Relational Pseudo-class 草案</a></p>
</blockquote>
<h1 id="The-Drag-and-Drop-Pseudo-class——-drop-drop"><a href="#The-Drag-and-Drop-Pseudo-class——-drop-drop" class="headerlink" title="The Drag-and-Drop Pseudo-class——:drop, :drop()"></a>The Drag-and-Drop Pseudo-class——:drop, :drop()</h1><blockquote>
<p><code>:drop</code> 和 <code>:drop()</code> 匹配可被放置拖动元素的目标元素，两者区别在于 <code>:drop()</code> 可以匹配一些规则，包括 <code>active</code>, <code>valid</code>, <code>invalid</code>。<code>active</code> 会匹配可被放置的目标元素，<code>valid</code> 匹配放置的元素为合法元素的目标元素，<code>invalid</code> 反之。如果 <code>:drop()</code> 括号里没有任何过滤，那么将和 <code>:drop</code> 没有区别。</p>
<p>想解锁更多姿势就去看 <a href="https://drafts.csswg.org/selectors-4/#selectordef-drop-function" target="_blank" rel="external">The Drag-and-Drop Pseudo-class 草案</a></p>
</blockquote>
<h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>其实这就是一篇科普文， 趁着国庆的闲余时间将 CSS Selectors Level 4 的一些新的特性总结了一下，可能有所错漏或理解错误，我十分的希望各位大牛帮我指出错误之处或不足之处！另外，祝大家国庆快乐。作为一只 single dog 还是写代码为好！</p>
<p>参考资料：</p>
<blockquote>
<p><a href="https://www.w3.org/TR/2013/WD-selectors4-20130502/" target="_blank" rel="external">https://www.w3.org/TR/2013/WD-selectors4-20130502/</a><br><a href="https://drafts.csswg.org/selectors-4/" target="_blank" rel="external">https://drafts.csswg.org/selectors-4/</a><br><a href="http://css4.rocks/selectors-level-4/" target="_blank" rel="external">http://css4.rocks/selectors-level-4/</a><br><a href="http://css4-selectors.com/selectors/" target="_blank" rel="external">http://css4-selectors.com/selectors/</a></p>
</blockquote>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/10/02/CSS-Level-4-中的新东西/" class="archive-article-date">
  	<time datetime="2016-10-02T13:25:50.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-10-02</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/">CSS</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/CSS-Selectors-Level-4/">CSS Selectors Level 4</a><a class="article-category-link" href="/categories/前端/CSS-Selectors-Level-4/CSS4/">CSS4</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-SameSite-Cookie——防御-CSRF-XSSI" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/07/10/SameSite-Cookie——防御-CSRF-XSSI/">SameSite-Cookie——防御 CSRF &amp; XSSI</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="SameSite——防御-CSRF-amp-XSSI-新机制"><a href="#SameSite——防御-CSRF-amp-XSSI-新机制" class="headerlink" title="SameSite——防御 CSRF &amp; XSSI 新机制"></a>SameSite——防御 CSRF &amp; XSSI 新机制</h1><blockquote>
<p><code>SameSite-cookies</code> 是 Google 开发的用于防御 CSRF 和 XSSI（Cross Site Script Inclusion，跨域脚本包含）的新安全机制，只需在 <code>Set-Cookie</code> 中加入一个新的字段属性，浏览器会根据设置的安全级别进行对应的安全 cookie 发送拦截，而目前在 Chrome-dev（51.0.2704.4）中可用。</p>
</blockquote>
<h2 id="XSSI——Cross-Site-Script-Inclusion"><a href="#XSSI——Cross-Site-Script-Inclusion" class="headerlink" title="XSSI——Cross Site Script Inclusion"></a>XSSI——Cross Site Script Inclusion</h2><p><code>XSSI</code> 属于 <code>XSS</code> 攻击的一种攻击方式，一般来说，浏览器允许网页加载其他域的脚本或图片等，假设我们在安全的网站上 a.com 包含一个脚本文件 <code>getData.js</code> 用于读取用户的私人信息，第一次用户需要在 a.com 登录，然后就可以根据验证返回用户私人信息并设置 cookie 以便下次使用，此时我们只做一个恶意网站 c.com，并包含了 <code>getData.js</code> 这个脚本文件，当用户点击 c.com 时，他的信息就泄露了。</p>
<p>当然，这种方法可以用 <code>token</code> 令牌等来解决，另外一种方法就是 <code>SameSite-Cookies</code>，通过验证是否是从 a.com 访问的 getData.js 的方式来阻止 cookie 的发送。</p>
<h2 id="SameSite-使用方式"><a href="#SameSite-使用方式" class="headerlink" title="SameSite 使用方式"></a>SameSite 使用方式</h2><p>需要在 <code>Set-Cookie</code> 中加入 <code>SameSite</code> 关键字，例如</p>
<blockquote>
<p>Set-Cookie: key=value; HttpOnly; SameSite=Strict</p>
</blockquote>
<h2 id="SameSite-的两个属性"><a href="#SameSite-的两个属性" class="headerlink" title="SameSite 的两个属性"></a>SameSite 的两个属性</h2><h3 id="no-restriction"><a href="#no-restriction" class="headerlink" title="no_restriction"></a>no_restriction</h3><p>当没有添加 SameSite 关键字的时候，默认是空的</p>
<h3 id="Lax"><a href="#Lax" class="headerlink" title="Lax"></a>Lax</h3><ul>
<li>允许发送安全 HTTP 方法（<code>GET</code>, <code>HEAD</code>, <code>OPTIONS</code>, <code>TRACE</code>）第三方链接的 cookies</li>
<li>必须是 TOP-LEVEL 即可引起地址栏变化的跳转方式，例如 <code>&lt;a&gt;</code>, <code>&lt;link rel=&quot;prerender&quot;&gt;</code>, <code>GET 方式的 form 表单</code>，此外，<code>XMLHttpRequest</code>, <code>&lt;img&gt;</code> 等方式进行 GET 方式的访问将不会发送 cookies</li>
<li>但是禁止发送不安全 HTTP 方法（<code>POST</code>, <code>PUT</code>, <code>DELETE</code>）第三方链接的cookies</li>
</ul>
<h3 id="Strict"><a href="#Strict" class="headerlink" title="Strict"></a>Strict</h3><p>禁止发送所有第三方链接的 cookies，默认情况下，如果添加了 SameSite 关键字，但是没有指定 value（Lax or Stict），那么默认为 Strict</p>
<h2 id="Strict-下的-Request-Cookie-变化"><a href="#Strict-下的-Request-Cookie-变化" class="headerlink" title="Strict 下的 Request Cookie 变化"></a>Strict 下的 Request Cookie 变化</h2><p>当我们通过其他网站来访问一个有 SameSite-Cookies 机制的网站时，例如从 a.com 点击链接进入 b.com，如果 b.com 设置了 <code>Set-Cookie:foo=bar;SameSite=Strict</code>，那么，<code>foo=bar</code> 这一 cookie 是不会随着 request 发送的，如下图：</p>
<p><img src="http://7xoehm.com1.z0.glb.clouddn.com/outerLink.png" alt="outerLink"></p>
<p>可以看到 <code>foo=bar</code> 并没有发送，假如此时刷新一下页面或者直接从地址栏输入 b.com 的地址，那么 cookie 将会正常发送，不过假设用户点击了外链进入了 b.com，由于 SameSite-Cookies 的保护，他的 cookie 第一次受到了保护，但是假设用户此时手动刷新了一下页面，那么 cookie 将会被发送出去，所以可能需要其他一些验证手段来对 cookie 未随 request 发送的情况来做相对应的处理，不过该种情况仅限于 GET 方法下，如下图：</p>
<p><img src="http://7xoehm.com1.z0.glb.clouddn.com/innerLink.png" alt="innerLink"></p>
<p>此外，为了更清楚地了解 cookie 中哪些字段是 SameSite 控制并且级别为 Lax 或 Strict 或 none，我们可以在 Chrome DevTools 上清楚地看到，如下图：</p>
<p><img src="http://7xoehm.com1.z0.glb.clouddn.com/devTools.png" alt="devTools"></p>
<p><a href="http://www.libinhong.com:5000" target="_blank" rel="external">点击查看 DEMO</a></p>
<p>参考资料：</p>
<ul>
<li><a href="http://www.sjoerdlangkemper.nl/2016/04/14/preventing-csrf-with-samesite-cookie-attribute/" target="_blank" rel="external">http://www.sjoerdlangkemper.nl/2016/04/14/preventing-csrf-with-samesite-cookie-attribute/</a></li>
<li><a href="https://tools.ietf.org/html/draft-west-first-party-cookies-07" target="_blank" rel="external">https://tools.ietf.org/html/draft-west-first-party-cookies-07</a></li>
<li><a href="https://chloe.re/2016/04/13/goodbye-csrf-samesite-to-the-rescue/" target="_blank" rel="external">https://chloe.re/2016/04/13/goodbye-csrf-samesite-to-the-rescue/</a></li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/07/10/SameSite-Cookie——防御-CSRF-XSSI/" class="archive-article-date">
  	<time datetime="2016-07-10T15:06:38.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-07-10</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cookie/">cookie</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/前端安全/">前端安全</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-reflow-和-repaint-简易分析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/17/reflow-和-repaint-简易分析/">reflow 和 repaint 简易分析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://7xoehm.com1.z0.glb.clouddn.com/1448333443367.jpg" alt="福利"></p>
<h1 id="浏览器渲染"><a href="#浏览器渲染" class="headerlink" title="浏览器渲染"></a>浏览器渲染</h1><p>当我们打开一个网页的时候，浏览器是如何将 HTML 代码转换为用户可见的视图的？浏览器又在何时进行 <code>repaint</code> 和 <code>reflow</code> 的操作？首先我们要先知道用于该操作的 <code>渲染树</code> 的由来。</p>
<h2 id="DOM-Tree-的生成"><a href="#DOM-Tree-的生成" class="headerlink" title="DOM Tree 的生成"></a>DOM Tree 的生成</h2><blockquote>
<p>浏览器首先会解析 HTML 代码，生成一颗 <code>DOM Tree</code>，DOM（文档对象模型）</p>
</blockquote>
<p>简单地说，<code>DOM Tree</code> 的生成一般经历了四个阶段</p>
<ul>
<li>转换——浏览器将从供应方（例如本地磁盘或服务器）获取到的 HTML 字节，根据 HTML 的文件编码格式转换为字符</li>
<li>符号化——浏览对转换好的字符串进行解析，将 <code>&lt;&gt;</code> 识别为对应的符号</li>
<li>词法分析——将符号化的字符串转换为 <code>对象</code>，一般来说是节点（Node）</li>
<li>DOM 构建——对象生成完毕后，将根据对象之间的关系（父子、兄弟）生成 <code>DOM Tree</code>，在 <code>DOM Tree</code> 中可以确认 Node 节点间的关系</li>
</ul>
<h2 id="CSSOM-的生成"><a href="#CSSOM-的生成" class="headerlink" title="CSSOM 的生成"></a>CSSOM 的生成</h2><blockquote>
<p>在生成 <code>DOM Tree</code> 以后，将会生成 <code>CSSOM</code>（CSS 对象模型）的树形结构</p>
</blockquote>
<p>与构建 <code>DOM</code> 的过程类似是，<code>CSSOM</code> 的构建过程也是读取 CSS 字节，进行转换解析，并生成对应的 <code>CSSOM Tree</code>，不同的是，<code>CSSOM</code> 为 CSS 样式服务，而 <code>DOM</code> 为节点服务</p>
<h3 id="CSSOM-能干什么？"><a href="#CSSOM-能干什么？" class="headerlink" title="CSSOM 能干什么？"></a>CSSOM 能干什么？</h3><p>CSSOM 通过复杂而具体的规则计算 CSS 样式，并将其映射到对应的需要样式的节点上，其遵循 <code>向下层叠</code> 的计算规则，例如下图</p>
<p><img src="http://7xoehm.com1.z0.glb.clouddn.com/cssom-tree.png" alt="向下层叠"></p>
<p>可以看到，body 处使用了 <code>font-size: 16px</code>，根据 <code>向下层叠</code> 的规则，body 的子节点如果没有其自己的 <code>font-size</code> 规则，那么 body 的 <code>font-size</code> 规则将会层叠给该节点</p>
<h3 id="CSSOM-注意点"><a href="#CSSOM-注意点" class="headerlink" title="CSSOM 注意点"></a>CSSOM 注意点</h3><ul>
<li><code>CSSOM</code> 的构建会阻塞页面的渲染——假设页面的呈现没有等待 <code>CSSOM</code> 的构建和计算，那么用户看到的将会是一堆没有样式的页面，等到 <code>CSSOM</code> 构建以后，页面又突然间变成有样式的页面，所以等待 <code>CSSOM</code> 的构建完成再进行渲染并呈现页面是必须的，不过如果 <code>CSSOM</code> 的构建的效率很低，那么将会出现常见的 <code>白屏</code> 现象。</li>
<li>只要重新加载页面，那么 <code>CSSOM</code> 也会重新构建——不管 CSS 样式文件是否被浏览器进行了缓存，<code>CSSOM</code> 是永远不会被缓存的，它会伴随页面的每一次重新加载而加载。</li>
<li>JS 的运行所阻塞会被 <code>CSSOM</code> 的构建阻塞——在构建 <code>DOM</code> 时，遇见 <code>&lt;script&gt;</code> 标签时，浏览器会发出 HTTP 请求资源，并将控制权移交给 JavaScript 引擎，等待 JS 执行完毕归还控制权继续 <code>DOM</code> 的构建，然而，如果此时 <code>CSSOM</code> 未下载并构建完成，JS 的执行时机将被延迟</li>
</ul>
<h2 id="Render-Tree——渲染树"><a href="#Render-Tree——渲染树" class="headerlink" title="Render Tree——渲染树"></a>Render Tree——渲染树</h2><blockquote>
<p><code>渲染树</code> 由 <code>DOM Tree</code> 和 <code>CSSOM Tree</code> 融合构成，渲染树与 <code>DOM Tree</code> 和 <code>CSSOM Tree</code> 不同，渲染树只包含需要渲染的节点信息，例如 <code>display: none</code> 的节点是不存在于 <code>渲染树</code> 内的</p>
</blockquote>
<p><img src="http://7xoehm.com1.z0.glb.clouddn.com/render-tree-construction.png" alt="合成渲染树"></p>
<p>可以发现，<code>span</code> 由于拥有 <code>display: none</code> 并未包含在 <code>渲染树</code> 里。</p>
<h2 id="渲染树构建和渲染步骤"><a href="#渲染树构建和渲染步骤" class="headerlink" title="渲染树构建和渲染步骤"></a>渲染树构建和渲染步骤</h2><p>在这里我们简单说一下 <code>渲染树</code> 的构建和渲染步骤：</p>
<ul>
<li>从 <code>DOM Tree</code> 根节点开始遍历所有可见节点<ul>
<li>不可见节点（如 <code>&lt;script&gt;</code> 和 <code>&lt;meta&gt;</code> 等）将不会包含在内，会被忽略</li>
<li>通过 CSS 样式设置不可见的节点也不被包括，例如 <code>display: none</code>，不包括 <code>visibility: hidden</code> 等</li>
</ul>
</li>
<li>从 <code>CSSOM Tree</code> 找到对应节点的规则，进行匹配</li>
<li>发射可见节点，连带其内容及计算的样式</li>
<li>根据生成的渲染树计算每个节点在屏幕中的绝对像素位置</li>
<li>根据计算结果开始渲染，这一步通常称为 <code>绘制</code> 或者 <code>栅格化</code></li>
</ul>
<h1 id="重绘（repaint）和重排（reflow）"><a href="#重绘（repaint）和重排（reflow）" class="headerlink" title="重绘（repaint）和重排（reflow）"></a>重绘（repaint）和重排（reflow）</h1><p>上面我们知道了 <code>渲染树</code> 由 <code>DOM Tree</code> 和 <code>CSSOM Tree</code> 融合构建而成，但是页面并不是进行一次渲染就可以适应各种节点的几何属性改变等变化的，页面会在某些时机进行 <code>重绘（repaint）</code> 和 <code>重排（reflow）</code>。</p>
<p>我们首先要知道其二者的区别：</p>
<ul>
<li>重绘（repaint）——页面部分样式属性改变了（背景颜色，字体颜色等），但是几何属性没有改变，页面需要重绘该部分的内容，这就叫 <code>重绘（repaint）</code></li>
<li>重排（reflow）——页面节点的几何属性改变，这时候需要重新计算元素的几何属性，重新构建 <code>渲染树</code>，这就叫 <code>重排（reflow）</code></li>
</ul>
<p>同时，我们要记得一下这句话：</p>
<blockquote>
<p>重绘不一定导致重排，但是重排一定会导致重绘</p>
</blockquote>
<h2 id="repaint-和-reflow-所带来的性能问题"><a href="#repaint-和-reflow-所带来的性能问题" class="headerlink" title="repaint 和 reflow 所带来的性能问题"></a>repaint 和 reflow 所带来的性能问题</h2><p>通过前面的分析，可以预见的是，<code>repaint</code> 和 <code>reflow</code> 所需的性能消耗代价必然巨大，下面通过一个例子来说明：</p>
<p>HTML:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"elem-a"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"elem-b"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"elem-c"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"elem-d"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>JavaScript:<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// example 1</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.time(<span class="string">"elem-a render time"</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> idx=<span class="number">0</span>;idx&lt;<span class="number">10000</span>;idx++) &#123;</div><div class="line">        <span class="built_in">document</span>.getElementById(<span class="string">"elem-a"</span>).innerHTML += idx;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">"elem-a render time"</span>);</div><div class="line">&#125;)();</div><div class="line"></div><div class="line"><span class="comment">// example 2</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.time(<span class="string">"elem-b render time"</span>);</div><div class="line">    <span class="keyword">let</span> elemB = <span class="built_in">document</span>.getElementById(<span class="string">"elem-b"</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> idx=<span class="number">0</span>;idx&lt;<span class="number">10000</span>;idx++) &#123;</div><div class="line">        elemB.innerHTML += idx;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">"elem-b render time"</span>);</div><div class="line">&#125;)();</div><div class="line"></div><div class="line"><span class="comment">// example 3</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.time(<span class="string">"elem-c render time"</span>);</div><div class="line">    <span class="keyword">let</span> str = <span class="string">""</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> idx=<span class="number">0</span>;idx&lt;<span class="number">10000</span>;idx++) &#123;</div><div class="line">        <span class="keyword">let</span> elemC = <span class="built_in">document</span>.getElementById(<span class="string">"elem-c"</span>);</div><div class="line">        str += idx;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"elem-c"</span>).innerHTML = str;</div><div class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">"elem-c render time"</span>);</div><div class="line">&#125;)();</div><div class="line"></div><div class="line"><span class="comment">// example 4</span></div><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.time(<span class="string">"elem-d render time"</span>);</div><div class="line">    <span class="keyword">let</span> elemD = <span class="built_in">document</span>.getElementById(<span class="string">"elem-d"</span>);</div><div class="line">    <span class="keyword">let</span> str = <span class="string">""</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> idx=<span class="number">0</span>;idx&lt;<span class="number">10000</span>;idx++) &#123;</div><div class="line">        str += idx;</div><div class="line">    &#125;</div><div class="line">    elemD.innerHTML += str;</div><div class="line">    <span class="built_in">console</span>.timeEnd(<span class="string">"elem-d render time"</span>);</div><div class="line">&#125;)();</div></pre></td></tr></table></figure></p>
<p>上面进行了 4 次试验，每次试验的内容不一样，下面进行分析：</p>
<ul>
<li>example 1——进行 10000 次的 “DOM 索引 + 重绘 + 重排”</li>
<li>example 2——进行 10000 次的 “重绘 + 重排”，进行 1 次的 “DOM 索引”</li>
<li>example 3——进行 10000 次的 “DOM 索引”，进行 1 次的 “重绘 + 重排”</li>
<li>example 4——进行 10000 次的 “字符串拼接”，进行一次的 “DOM 索引 + 重绘 + 重排”</li>
</ul>
<p>控制台打印结果如下：</p>
<ul>
<li>elem-a render time: 6020.826ms</li>
<li>elem-b render time: 5797.140ms</li>
<li>elem-c render time: 14.061ms</li>
<li>elem-d render time: 3.905ms</li>
</ul>
<p>由结果分析可知：</p>
<ul>
<li><code>repaint</code> 和 <code>reflow</code> 消耗的性能是无比巨大的</li>
<li>DOM 索引也消耗一定的性能，但是比起 <code>repaint</code> 和 <code>reflow</code> 简直是小巫见大巫</li>
<li>优化的重点在于减少 DOM 重复索引和循环引起的 <code>repaint</code> 和 <code>reflow</code>，尽量压缩为一次</li>
</ul>
<h2 id="如何减少-repaint-和-reflow-的发生？"><a href="#如何减少-repaint-和-reflow-的发生？" class="headerlink" title="如何减少 repaint 和 reflow 的发生？"></a>如何减少 <code>repaint</code> 和 <code>reflow</code> 的发生？</h2><p>要知道如何减少 <code>repaint</code> 和 <code>reflow</code> 的发生，我们就得先知道引起它们的原因， <code>repaint</code> 无疑就是改变 DOM 的背景颜色等导致，重点在于 <code>reflow</code> 的原因：</p>
<ul>
<li>页面初始化必须进行一次的 <code>reflow</code></li>
<li>缩放窗口</li>
<li>改变字体</li>
<li>添加或删除样式</li>
<li>添加或删除元素</li>
<li>内容改变，例如用户在输入框中输入文本</li>
<li>激活了伪类样式，例如：hover</li>
<li>脚本操作 DOM 并改变了其样式</li>
<li>计算 offsetWidth 和 offsetHeight</li>
<li>设置样式属性（width，height等）</li>
</ul>
<p>以上种种都有可能引起页面的 <code>reflow</code>，而且不止这些，但是我们无法完全避免 <code>reflow</code>，所以我们必须想方设法去减少 <code>reflow</code>，例如：</p>
<ul>
<li>减少单一操作样式属性，使用 class 一次性替换</li>
<li>对有动画的元素，使其 <code>position</code> 为 <code>fixed</code> 或 <code>absolute</code>，这样会减少元素间的影响</li>
<li>使用平滑的过渡动画，例如尽量少用 1 个像素的移动动画，可以改为 3 个像素，<a href="http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/#smooth" target="_blank" rel="external">具体原因</a></li>
<li>避免使用 table 布局，<a href="http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/#tables" target="_blank" rel="external">具体原因</a></li>
<li>减少在 CSS 样式中使用 JS 表达式</li>
<li>将元素 <code>display: none</code> 后再修改样式</li>
<li>创建一个新的节点元素，进行样式操作后替代原先的元素，不过可能会出现页面闪烁</li>
<li>创建 DocumentFragment 来进行更新</li>
</ul>
<p>这里提一下浏览器自身对减少 <code>reflow</code> 的优化，下面例子：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> elemA = <span class="built_in">document</span>.getElementById(<span class="string">"elem-a"</span>);</div><div class="line"></div><div class="line">elemA.style.width = <span class="string">"100px"</span>;</div><div class="line">elemA.style.height = <span class="string">"100px"</span>;</div><div class="line">elemA.style.backgroundColor = <span class="string">"yellow"</span>;</div></pre></td></tr></table></figure></p>
<p>以上例子浏览器只会一次性进行 <code>reflow</code> 而非 3 次</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> elemA = <span class="built_in">document</span>.getElementById(<span class="string">"elem-a"</span>);</div><div class="line"></div><div class="line">elemA.style.width = <span class="string">"100px"</span>;</div><div class="line">elemA.style.height = <span class="string">"100px"</span>;</div><div class="line">elemA.getComputedStyle();</div><div class="line">elemA.style.backgroundColor = <span class="string">"yellow"</span>;</div></pre></td></tr></table></figure>
<p>以上例子浏览器会进行 2 次 <code>reflow</code>，因为中间需要获取当前的样式信息，浏览器必须先进行 <code>渲染树</code> 的重新计算，只要是获取以下样式信息的，都会引起浏览器立即重新渲染（如果必须则会 <code>reflow</code>）：</p>
<ul>
<li>offsetTop</li>
<li>offsetLeft</li>
<li>offsetWidth</li>
<li>offsetHeight</li>
<li>scrollTop</li>
<li>scrollLeft</li>
<li>scrollWidth</li>
<li>scrollHeight</li>
<li>clientTop</li>
<li>clientLeft</li>
<li>clientWidth</li>
<li>clientHeight</li>
<li>getComputedStyle()</li>
<li>currentStyle（just for IE）</li>
</ul>
<blockquote>
<p>参考</p>
</blockquote>
<ul>
<li><a href="https://varvy.com/performance/cssom.html" target="_blank" rel="external">https://varvy.com/performance/cssom.html</a></li>
<li><a href="http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/" target="_blank" rel="external">http://www.stubbornella.org/content/2009/03/27/reflows-repaints-css-performance-making-your-javascript-slow/</a></li>
<li><a href="https://developers.google.com/web/fundamentals/performance/critical-rendering-path/constructing-the-object-model?hl=zh-cn" target="_blank" rel="external">https://developers.google.com/web/fundamentals/performance/critical-rendering-path/constructing-the-object-model?hl=zh-cn</a></li>
<li><a href="http://taligarsiel.com/Projects/howbrowserswork1.htm" target="_blank" rel="external">http://taligarsiel.com/Projects/howbrowserswork1.htm</a></li>
<li><a href="http://www.cnblogs.com/zichi/p/4720000.html" target="_blank" rel="external">http://www.cnblogs.com/zichi/p/4720000.html</a></li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/06/17/reflow-和-repaint-简易分析/" class="archive-article-date">
  	<time datetime="2016-06-17T02:16:50.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-06-17</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CSS/">CSS</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/CSS/">CSS</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-angular-注意点-长期更新" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/06/05/angular-注意点-长期更新/">angular 注意点（长期更新）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>这篇 blog 主要存放我在学习和使用 angular 踩到的坑和需要注意的点</p>
</blockquote>
<h1 id="ng-repeat"><a href="#ng-repeat" class="headerlink" title="ng-repeat"></a>ng-repeat</h1><blockquote>
<p><code>ng-repeat</code> 用于标识某个 elem 需要重复输出，同时重复输出的内容需为唯一</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-app</span>=<span class="string">"app"</span> <span class="attr">ng-controller</span>=<span class="string">"control"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">ng-repeat</span>=<span class="string">"content in repeatContent"</span>&gt;</span>ng-repeat: &#123;&#123; content &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> app = angular.module(<span class="string">"app"</span>, []);</div><div class="line">app.controller(<span class="string">"control"</span>, ($scope) =&gt; &#123;</div><div class="line">    <span class="comment">// 输出李滨泓</span></div><div class="line">    $scope.repeatContent = [<span class="string">"李"</span>, <span class="string">"滨"</span>, <span class="string">"泓"</span>];</div><div class="line">    <span class="comment">// 下面存在两个“泓”，会报错</span></div><div class="line">    <span class="comment">// $scope.repeatContent = ["李", "滨", "泓", "泓"];</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h1 id="provider-service-factory-之间的关系"><a href="#provider-service-factory-之间的关系" class="headerlink" title="provider, service, factory 之间的关系"></a>provider, service, factory 之间的关系</h1><h2 id="factory"><a href="#factory" class="headerlink" title="factory"></a>factory</h2><blockquote>
<p><code>factory</code> 很像 <code>service</code>，不同之处在于，service 在 Angular 中是一个单例对象，即当需要使用 service 时，使用 new 关键字来创建一个（也仅此一个）service。而 factory 则是一个普通的函数，当需要用时，他也仅仅是一个普通函数的调用方式，它可以返回各种形式的数据，例如通过返回一个功能函数的集合对象来将供与使用。</p>
</blockquote>
<p>定义：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> app = angular.module(<span class="string">"app"</span>, []);</div><div class="line"></div><div class="line"><span class="comment">// 这里可以注入 $http 等 Provider</span></div><div class="line">app.factory(<span class="string">"Today"</span>, () =&gt; &#123;</div><div class="line">    <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">year</span>: date.getFullYear(),</div><div class="line">        <span class="attr">month</span>: date.getMonth() + <span class="number">1</span>,</div><div class="line">        <span class="attr">day</span>: date.getDate()</div><div class="line">    &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>使用注入：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">"control"</span>, (Today) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(Today.year);</div><div class="line">    <span class="built_in">console</span>.log(Today.month);</div><div class="line">    <span class="built_in">console</span>.log(Today.day);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="service"><a href="#service" class="headerlink" title="service"></a>service</h2><blockquote>
<p><code>service</code> 在使用时是一个单例对象，同时也是一个 constructor，它的特点让它可以不返回任何东西，因为它使用 new 关键字新建，同时它可以用在 controller 之间的通讯与数据交互，因为 controller 在无用时其作用域链会被销毁（例如使用路由跳转到另一个页面，同时使用了另一个 controller）</p>
</blockquote>
<p>定义：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> app = angular.module(<span class="string">"app"</span>, []);</div><div class="line"></div><div class="line"><span class="comment">// 这里可以注入 $http 等 Provider</span></div><div class="line"><span class="comment">// 注意这里不可以使用 arrow function</span></div><div class="line"><span class="comment">// arrow function 不能作为 constructor</span></div><div class="line">app.service(<span class="string">"Today"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">this</span>.year = date.getFullYear();</div><div class="line">    <span class="keyword">this</span>.month = date.getMonth() + <span class="number">1</span>;</div><div class="line">    <span class="keyword">this</span>.day = date.getDate();</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>使用注入：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">"control"</span>, (Today) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(Today.year);</div><div class="line">    <span class="built_in">console</span>.log(Today.month);</div><div class="line">    <span class="built_in">console</span>.log(Today.day);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h2 id="provider"><a href="#provider" class="headerlink" title="provider"></a>provider</h2><blockquote>
<p><code>provider</code> 是 <code>service</code> 的底层创建方式，可以理解 provider 是一个可配置版的 service，我们可以在正式注入 provider 前对 provider 进行一些参数的配置。</p>
</blockquote>
<p>定义：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> app = angular.module(<span class="string">"app"</span>, []);</div><div class="line"></div><div class="line"><span class="comment">// 这里可以注入 $http 等 Provider</span></div><div class="line"><span class="comment">// 注意这里不可以使用 arrow function</span></div><div class="line"><span class="comment">// arrow function 不能作为 constructor</span></div><div class="line">app.provider(<span class="string">"Today"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.date = <span class="keyword">new</span> <span class="built_in">Date</span>();</div><div class="line">    <span class="keyword">let</span> self = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.setDate = <span class="function">(<span class="params">year, month, day</span>) =&gt;</span> &#123;</div><div class="line">        <span class="keyword">this</span>.date = <span class="keyword">new</span> <span class="built_in">Date</span>(year, month - <span class="number">1</span>, day);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">this</span>.$get = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">            <span class="attr">year</span>: <span class="keyword">this</span>.date.getFullYear(),</div><div class="line">            <span class="attr">month</span>: <span class="keyword">this</span>.date.getMonth() + <span class="number">1</span>,</div><div class="line">            <span class="attr">day</span>: <span class="keyword">this</span>.date.getDate()</div><div class="line">        &#125;;</div><div class="line">    &#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>使用注入：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 这里重新配置了今天的日期是 2015年2月15日</span></div><div class="line"><span class="comment">// 注意这里注入的是 TodayProvider，使用驼峰命名来注入正确的需要配置的 provider</span></div><div class="line">app.config(<span class="function">(<span class="params">TodayProvider</span>) =&gt;</span> &#123;</div><div class="line">    TodayProvider.setDate(<span class="number">2015</span>, <span class="number">2</span>, <span class="number">15</span>);</div><div class="line">&#125;);</div><div class="line"></div><div class="line">app.controller(<span class="string">"control"</span>, (Today) =&gt; &#123;</div><div class="line">    <span class="built_in">console</span>.log(Today.year);</div><div class="line">    <span class="built_in">console</span>.log(Today.month);</div><div class="line">    <span class="built_in">console</span>.log(Today.day);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<h1 id="handlebars-与-angular-符号解析冲突"><a href="#handlebars-与-angular-符号解析冲突" class="headerlink" title="handlebars 与 angular 符号解析冲突"></a>handlebars 与 angular 符号解析冲突</h1><p>场景：</p>
<blockquote>
<p>当我使用 node.js 作为服务端，而其中使用了 handlebars 作为模板引擎，当 node.js 对某 URL 进行相应并 render，由于其模板使用 <code>{ {} }</code> 作为变量解析符号。同样地，angular 也使用 <code>{ {} }</code> 作为变量解析符号，所以当 node.js 进行 render 页面后，如果 <code>{ {} }</code> 内的变量不存在，则该个区域会被清空，而我的原意是这个作为 angular 的解析所用，而不是 handlebars 使用，同时我也想继续使用 handlebars，那么此时就需要将 angular 默认的 <code>{ {} }</code> 解析符号重新定义。即使用依赖注入 <code>$interpolateProvider</code> 进行定义，如下示例：</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">app.config(<span class="function"><span class="params">$interpolateProvider</span> =&gt;</span> &#123;</div><div class="line">    $interpolateProvider.startSymbol(<span class="string">'&#123;[&#123;'</span>);</div><div class="line">    $interpolateProvider.endSymbol(<span class="string">'&#125;]&#125;'</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h1 id="ng-annotate-loader"><a href="#ng-annotate-loader" class="headerlink" title="ng-annotate-loader"></a>ng-annotate-loader</h1><blockquote>
<p><code>ng-annotate-loader</code> 应用于 webpack + angular 的开发场景，是用于解决 angular 在进行 JS 压缩后导致依赖注入失效并出现错误的解决方法</p>
</blockquote>
<p>安装<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ npm install ng-annotate-loader --save-dev</div></pre></td></tr></table></figure></p>
<p>配置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// webpack.config.js</span></div><div class="line">&#123;</div><div class="line">    <span class="attr">test</span>: <span class="regexp">/\.js?$/</span>,</div><div class="line">    <span class="attr">exclude</span>: <span class="regexp">/(node_modules|bower_components)/</span>,</div><div class="line">    <span class="attr">loader</span>: <span class="string">'ng-annotate!babel?presets=es2015'</span></div><div class="line">&#125;,</div></pre></td></tr></table></figure></p>
<h1 id="双向数据绑定"><a href="#双向数据绑定" class="headerlink" title="双向数据绑定"></a>双向数据绑定</h1><blockquote>
<p>当我们使用非 Angular 自带的事件时，$scope 里的数据改变并不会引起 <code>$digest</code> 的 <code>dirty-checking</code> 循环，这将导致当 <code>model</code> 改变时，<code>view</code> 不会同步更新，这时我们需要自己主动触发更新</p>
</blockquote>
<p>HTML<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123; foo &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"addBtn"</span>&gt;</span>go<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>JavaScript<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">"control"</span>, ($scope) =&gt; &#123;</div><div class="line">    $scope.foo = <span class="number">0</span>;</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"addBtn"</span>).addEventListener(<span class="string">"click"</span>, () =&gt; &#123;</div><div class="line">        $scope.foo++;</div><div class="line">    &#125;, <span class="literal">false</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>很明显，示例的意图是当点击 button 时，<code>foo</code> 自增长并更新 View，但是实际上，$scope.foo 是改变了，但是 View 并不会刷新，这是因为 foo 并没有一个 $watch 检测变化后 $apply，最终引起 $digest，所以我们需要自己触发 $apply 或者创建一个 $watch 来触发或检测数据变化</p>
<p>JavaScript（使用 $apply）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">"control"</span>, ($scope) =&gt; &#123;</div><div class="line">    $scope.foo = <span class="number">0</span>;</div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"addBtn"</span>).addEventListener(<span class="string">"click"</span>, () =&gt; &#123;</div><div class="line">        </div><div class="line">        $scope.$apply(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            $scope.foo++;</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">    &#125;, <span class="literal">false</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>JavaScript（使用 $watch &amp; $digest）<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">app.controller(<span class="string">"control"</span>, ($scope) =&gt; &#123;</div><div class="line">    $scope.foo = <span class="number">0</span>;</div><div class="line">    $scope.flag = <span class="number">0</span>;</div><div class="line"></div><div class="line">    $scope.$watch(<span class="string">"flag"</span>, (newValue, oldValue) =&gt; &#123;</div><div class="line"></div><div class="line">        <span class="comment">// 当 $digest 循环检测 flag 时，如果新旧值不一致将调用该函数</span></div><div class="line">        $scope.foo = $scope.flag;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="built_in">document</span>.getElementById(<span class="string">"addBtn"</span>).addEventListener(<span class="string">"click"</span>, () =&gt; &#123;</div><div class="line">       </div><div class="line">        $scope.flag++;</div><div class="line">        <span class="comment">// 主动触发 $digest 循环</span></div><div class="line">        $scope.$digest();</div><div class="line">    &#125;, <span class="literal">false</span>);</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<h2 id="watch-watchExpression-listener-objectEquality"><a href="#watch-watchExpression-listener-objectEquality" class="headerlink" title="$watch(watchExpression, listener, [objectEquality])"></a>$watch(watchExpression, listener, [objectEquality])</h2><blockquote>
<p>注册一个 <code>listener</code> 回调函数，在每次 <code>watchExpression</code> 的值发生改变时调用</p>
</blockquote>
<ul>
<li><code>watchExpression</code> 在每次 <code>$digest</code> 执行时被调用，并返回要被检测的值（当多次输入同样的值时，<code>watchExpression</code> 不应该改变其自身的值，否则可能会引起多次的 $digest 循环，<code>watchExpression</code> 应该幂等）</li>
<li><code>listener</code> 将在当前 <code>watchExpression</code> 返回值和上次的 <code>watchExpression</code> 返回值不一致时被调用（使用 <code>!==</code> 来严格地判断不一致性，而不是使用 <code>==</code> 来判断，不过 <code>objectEquality == true</code> 除外）</li>
<li><code>objectEquality</code> 为 <code>boolean</code> 值，当为 <code>true</code> 时，将使用 <code>angular.equals</code> 来判断一致性，并使用 <code>angular.copy</code> 来保存此次的 Object 拷贝副本供给下一次的比较，这意味着复杂的对象检测将会有性能和内存上的问题</li>
</ul>
<h2 id="apply-exp"><a href="#apply-exp" class="headerlink" title="$apply([exp])"></a>$apply([exp])</h2><blockquote>
<p><code>$apply</code> 是 <code>$scope</code> 的一个函数，用于触发 <code>$digest</code> 循环</p>
</blockquote>
<p>$apply 伪代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">$apply</span>(<span class="params">expr</span>) </span>&#123;</div><div class="line">    <span class="keyword">try</span> &#123;</div><div class="line">        <span class="keyword">return</span> $<span class="built_in">eval</span>(expr);</div><div class="line">    &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">        $exceptionHandler(e);</div><div class="line">    &#125; <span class="keyword">finally</span> &#123;</div><div class="line">        $root.$digest();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<ul>
<li>使用 <code>$eval(expr)</code> 执行 <code>expr</code> 表达式</li>
<li>如果在执行过程中跑出 exception，那么执行 $exceptionHandler(e)</li>
<li>最后无论结果，都会执行一次 <code>$digest</code> 循环</li>
</ul>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/06/05/angular-注意点-长期更新/" class="archive-article-date">
  	<time datetime="2016-06-05T09:30:38.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-06-05</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/Angular/">Angular</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-Webpack-Babel-使用-ES6-新特性" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/05/04/Webpack-Babel-使用-ES6-新特性/">webpack + Babel 使用 ES6 新特性</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>webpack 是一个模块加载器兼打包工具，Babel 是一款转码编译器，可以很方便地将 ES6、ES7 等当前浏览器不兼容的 JavaScript 新特性转码为 ES5 等当前浏览器普遍兼容的代码。将两者结合起来可以很方便地在项目中一边使用 ES6 编写代码，一边自动生成 ES5 代码</p>
</blockquote>
<h1 id="webpack-amp-Babel"><a href="#webpack-amp-Babel" class="headerlink" title="webpack &amp; Babel"></a>webpack &amp; Babel</h1><h2 id="安装-webpack"><a href="#安装-webpack" class="headerlink" title="安装 webpack"></a>安装 webpack</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install webpack -g</div></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm init</div><div class="line">npm install webpack --save-dev</div></pre></td></tr></table></figure></p>
<h2 id="安装-Babel-相关组件"><a href="#安装-Babel-相关组件" class="headerlink" title="安装 Babel 相关组件"></a>安装 Babel 相关组件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装加载器 babel-loader 和 Babel 的 API 代码 babel-core</span></div><div class="line">npm install --save-dev babel-loader babel-core</div><div class="line"><span class="comment"># 安装 ES2015（ES6）的代码，用于转码</span></div><div class="line">npm install babel-preset-es2015 --save-dev</div><div class="line"><span class="comment"># 用于转换一些 ES6 的新 API，如 Generator，Promise 等</span></div><div class="line">npm install --save babel-polyfill</div></pre></td></tr></table></figure>
<p>你可以在以下页面查看 JavaScript 的所需的转换代码模块进行按需安装<br><a href="http://babeljs.io/docs/plugins/preset-es2015/" target="_blank" rel="external">http://babeljs.io/docs/plugins/preset-es2015/</a></p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><blockquote>
<p>类似于 Grunt 和 Gulp，webpack 也有其特定地配置文件 <code>webpack.config.js</code></p>
</blockquote>
<p>如下配置使用babel：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="attr">entry</span>: [</div><div class="line">        <span class="string">"babel-polyfill"</span>,</div><div class="line">        <span class="string">"./index.js"</span></div><div class="line">    ],</div><div class="line"></div><div class="line">    <span class="attr">output</span>: &#123;</div><div class="line">        <span class="attr">path</span>: __dirname + <span class="string">'/output/'</span>,</div><div class="line">        <span class="attr">publicPath</span>: <span class="string">"/output/"</span>,</div><div class="line">        <span class="attr">filename</span>: <span class="string">'index.js'</span></div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    <span class="attr">module</span>: &#123;</div><div class="line">        <span class="attr">loaders</span>: [</div><div class="line">            &#123;</div><div class="line">                <span class="attr">test</span>: <span class="regexp">/\.jsx?$/</span>,</div><div class="line">                <span class="attr">exclude</span>: <span class="regexp">/(node_modules|bower_components)/</span>,</div><div class="line">                <span class="attr">loader</span>: <span class="string">'babel-loader'</span>, <span class="comment">// 'babel-loader' is also a legal name to reference</span></div><div class="line">                query: &#123;</div><div class="line">                    <span class="attr">presets</span>: [<span class="string">'es2015'</span>]</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        ]</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<ul>
<li>entry——用于设置 webpack 执行打包文件的入口，是一个数组</li>
<li>output——用于指定生成文件的路径以及文件名等<ul>
<li>path——指定生成文件路径</li>
<li>publicPath——指定域名公共路径</li>
<li>filename——指定生成文件的名称</li>
</ul>
</li>
<li>module——主要用于配置 <code>loaders</code><ul>
<li>loaders——用于配置对应后缀的文件使用何种加载器进行处理<ul>
<li>test——使用正则表达式来指定某种特定的文件类型</li>
<li>exclude——排除某个文件夹下的文件进行处理</li>
<li>loader——指定相应的加载器，多个加载器使用 <code>!</code> 进行连接，每个 loader 都可以省略其后缀，如 <code>babel-loader</code> 可以写成 <code>babel</code></li>
<li>query——指定加载器的配置信息，也可以使用 <code>?</code> 直接连接在 <code>loader</code> 后面</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>以上只是涉及到我目前用到的一些配置信息的说明，更多的配置信息可以查阅官方文档，地址如下：<br><a href="https://webpack.github.io/docs/configuration.html" target="_blank" rel="external">https://webpack.github.io/docs/configuration.html</a></p>
<h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><p>在有 <code>webpack.config.js</code> 文件的目录下使用一下命令行：</p>
<ul>
<li><code>webpack</code>——直接启动 webpack，默认配置文件为 <code>webpack.config.js</code></li>
<li><code>webpack -w</code>——监测启动 webpack，实时打包更新文件</li>
<li><code>webpack -p</code>——对打包后的文件进行压缩</li>
</ul>
<p>更多的命令可以查看官方文档下的说明，地址如下：<br><a href="http://webpack.github.io/docs/cli.html" target="_blank" rel="external">http://webpack.github.io/docs/cli.html</a></p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/05/04/Webpack-Babel-使用-ES6-新特性/" class="archive-article-date">
  	<time datetime="2016-05-04T14:49:46.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-05-04</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/ECMAScript-6/">ECMAScript 6</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ES6-学习笔记（七）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/24/ES6-学习笔记（七）/">ES6 学习笔记（七）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Generator"><a href="#Generator" class="headerlink" title="Generator"></a>Generator</h1><blockquote>
<p><code>Generator</code> 函数是ES6提供的一种异步编程解决方案，语法行为与传统函数完全不同</p>
</blockquote>
<h2 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 这里的 * 只要在 function 和函数名之间使用就可以</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">iterator</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">yield</span> <span class="string">"x"</span>;</div><div class="line">    <span class="keyword">yield</span> <span class="string">"y"</span>;</div><div class="line">    <span class="keyword">return</span> <span class="string">"z"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> iter = iterator();</div><div class="line"></div><div class="line">iter.next(); <span class="comment">// &#123;value: "x", done: false&#125;</span></div><div class="line">iter.next(); <span class="comment">// &#123;value: "y", done: false&#125;</span></div><div class="line">iter.next(); <span class="comment">// &#123;value: "z", done: true&#125;</span></div><div class="line">iter.next(); <span class="comment">// &#123;value: undefined, done: true&#125;</span></div></pre></td></tr></table></figure>
<p>调用 Generator 函数并不会如同普通函数一样返回函数的返回值，而是返回一个迭代器对象。<code>yield</code> 用于惰性执行 Generator 函数，当调用迭代器对象的 <code>next()</code> 时，就会执行函数内的代码知道遇到一个 <code>yield</code> 声明，并且其后面的值作为 <code>value</code> 的值返回，如果程序执行完毕，那么 <code>done</code> 是 <code>true</code>，反之是 <code>false</code></p>
<h2 id="next"><a href="#next" class="headerlink" title="next()"></a>next()</h2><p><code>next()</code> 是 Generator 函数的步骤执行的调用者，同时可以利用它来为函数内部注入值</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">foo</span>(<span class="params">x</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> y = <span class="number">2</span> * (<span class="keyword">yield</span> (x + <span class="number">1</span>));</div><div class="line">  <span class="keyword">var</span> z = <span class="keyword">yield</span> (y / <span class="number">3</span>);</div><div class="line">  <span class="keyword">return</span> (x + y + z);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = foo(<span class="number">5</span>);</div><div class="line">a.next() <span class="comment">// Object&#123;value:6, done:false&#125;</span></div><div class="line">a.next() <span class="comment">// Object&#123;value:NaN, done:false&#125;</span></div><div class="line">a.next() <span class="comment">// Object&#123;value:NaN, done:true&#125;</span></div><div class="line"></div><div class="line"><span class="comment">// 一开始 x 为 5，所以 yield 惰性求值返回为 6</span></div><div class="line"><span class="keyword">var</span> b = foo(<span class="number">5</span>);</div><div class="line">b.next() <span class="comment">// &#123; value:6, done:false &#125;</span></div><div class="line"><span class="comment">// 这里相当于声明上一个 yield 的返回值是 12，所以 y 等于 2*12</span></div><div class="line">b.next(<span class="number">12</span>) <span class="comment">// &#123; value:8, done:false &#125;</span></div><div class="line"><span class="comment">// 这里相当于声明上一个 yield 的返回值是 13，所以 z 等于 13</span></div><div class="line">b.next(<span class="number">13</span>) <span class="comment">// &#123; value:42, done:true &#125;</span></div></pre></td></tr></table></figure>
<h2 id="使用-for…of"><a href="#使用-for…of" class="headerlink" title="使用 for…of"></a>使用 for…of</h2><p>由于 Generator 函数调用返回一个迭代器对象 ，那么他就可以被所有支持迭代器遍历的特性使用，例如 for…of</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> *<span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">4</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">5</span>;</div><div class="line">  <span class="keyword">return</span> <span class="number">6</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> foo()) &#123;</div><div class="line">  <span class="built_in">console</span>.log(v);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1 2 3 4 5</span></div><div class="line"><span class="comment">// 由于当迭代器返回的 done 是 true 就停止遍历，所以 6 并不会被输出</span></div></pre></td></tr></table></figure>
<p>除了 for…of，<code>...</code>  运算符和 <code>Array.from()</code> 同样支持 Generator</p>
<h2 id="Generator-prototype-throw"><a href="#Generator-prototype-throw" class="headerlink" title="Generator.prototype.throw()"></a>Generator.prototype.throw()</h2><blockquote>
<p>Generator函数返回的遍历器对象，都有一个throw方法，可以在函数体外抛出错误，然后在Generator函数体内捕获</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> g = <span class="function"><span class="keyword">function</span>* (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">try</span> &#123;</div><div class="line">    <span class="keyword">yield</span>;</div><div class="line">  &#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'内部捕获'</span>, e);</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">var</span> i = g();</div><div class="line">i.next();</div><div class="line"></div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">  <span class="comment">// 内部捕获后不再捕获此后的错误</span></div><div class="line">  i.throw(<span class="string">'a'</span>);</div><div class="line">  <span class="comment">// 内部不捕获，传递到外部</span></div><div class="line">  i.throw(<span class="string">'b'</span>);</div><div class="line">&#125; <span class="keyword">catch</span> (e) &#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'外部捕获'</span>, e);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 内部捕获 a</span></div><div class="line"><span class="comment">// 外部捕获 b</span></div></pre></td></tr></table></figure>
<h2 id="Generator-prototype-return"><a href="#Generator-prototype-return" class="headerlink" title="Generator.prototype.return()"></a>Generator.prototype.return()</h2><blockquote>
<p>Generator函数返回的遍历器对象，还有一个return方法，可以返回给定的值，并且终结遍历Generator函数</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">gen</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> g = gen();</div><div class="line"></div><div class="line">g.next()        <span class="comment">// &#123; value: 1, done: false &#125;</span></div><div class="line">g.return(<span class="string">'foo'</span>) <span class="comment">// &#123; value: "foo", done: true &#125;</span></div><div class="line">g.next()        <span class="comment">// &#123; value: undefined, done: true &#125;</span></div></pre></td></tr></table></figure>
<h2 id="yield"><a href="#yield" class="headerlink" title="yield*"></a>yield*</h2><p><code>yield*</code> 用于在 Generator 函数内调用另一个 Generator 函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'x'</span>;</div><div class="line">  <span class="keyword">yield</span>* foo();</div><div class="line">  <span class="keyword">yield</span> <span class="string">'y'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 等同于</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'x'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'a'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'b'</span>;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'y'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 等同于</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'x'</span>;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> foo()) &#123;</div><div class="line">    <span class="keyword">yield</span> v;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'y'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> bar())&#123;</div><div class="line">  <span class="built_in">console</span>.log(v);</div><div class="line">&#125;</div><div class="line"><span class="comment">// "x"</span></div><div class="line"><span class="comment">// "a"</span></div><div class="line"><span class="comment">// "b"</span></div><div class="line"><span class="comment">// "y"</span></div><div class="line"></div><div class="line"><span class="comment">// 另外一个例子</span></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">inner</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'hello!'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">outer1</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'open'</span>;</div><div class="line">  <span class="keyword">yield</span> inner();</div><div class="line">  <span class="keyword">yield</span> <span class="string">'close'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = outer1()</div><div class="line">gen.next().value <span class="comment">// "open"</span></div><div class="line">gen.next().value <span class="comment">// 返回一个遍历器对象</span></div><div class="line">gen.next().value <span class="comment">// "close"</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span>* <span class="title">outer2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">yield</span> <span class="string">'open'</span></div><div class="line">  <span class="keyword">yield</span>* inner()</div><div class="line">  <span class="keyword">yield</span> <span class="string">'close'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> gen = outer2()</div><div class="line">gen.next().value <span class="comment">// "open"</span></div><div class="line">gen.next().value <span class="comment">// "hello!"</span></div><div class="line">gen.next().value <span class="comment">// "close"</span></div></pre></td></tr></table></figure>
<blockquote>
<p>Generator 函数的丰富超乎想象，这里写的笔记只是其冰山一角的特性，更多还是需要阅读相关书籍和资料<br>以上实例代码大部分来自阮一峰老师的 《ECMAScript 6 入门》 一书<br>书籍在线阅读地址: <a href="http://es6.ruanyifeng.com/#README" target="_blank" rel="external">http://es6.ruanyifeng.com/#README</a></p>
</blockquote>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/24/ES6-学习笔记（七）/" class="archive-article-date">
  	<time datetime="2016-04-24T07:19:08.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-24</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/ECMAScript-6/">ECMAScript 6</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ES6-学习笔记（六）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/23/ES6-学习笔记（六）/">ES6 学习笔记（六）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Iterator"><a href="#Iterator" class="headerlink" title="Iterator"></a>Iterator</h1><blockquote>
<p>Iterator的作用有三个：一是为各种数据结构，提供一个统一的、简便的访问接口；二是使得数据结构的成员能够按某种次序排列；三是ES6创造了一种新的遍历命令for…of循环，Iterator接口主要供for…of消费</p>
</blockquote>
<h2 id="部署-Iterator-接口"><a href="#部署-Iterator-接口" class="headerlink" title="部署 Iterator 接口"></a>部署 Iterator 接口</h2><p>数组、Map、Set、类数组都有部署 Iterator 的接口，但是对象并没有，下面展示如何为对象部署 Iterator 接口</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// 第一种</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">RangeIterator</span> </span>&#123;</div><div class="line">  <span class="keyword">constructor</span>(start, stop) &#123;</div><div class="line">    <span class="keyword">this</span>.value = start;</div><div class="line">    <span class="keyword">this</span>.stop = stop;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// Symbol.Iterator 即部署接口</span></div><div class="line">  [<span class="built_in">Symbol</span>.iterator]() &#123; <span class="keyword">return</span> <span class="keyword">this</span>; &#125;</div><div class="line"></div><div class="line">  <span class="comment">// next() 代表迭代器的指针运动逻辑</span></div><div class="line">  <span class="comment">// value 默认是当前值</span></div><div class="line">  <span class="comment">// done 表示当前值是否为末尾，布尔值</span></div><div class="line">  next() &#123;</div><div class="line">    <span class="keyword">var</span> value = <span class="keyword">this</span>.value;</div><div class="line">    <span class="keyword">if</span> (value &lt; <span class="keyword">this</span>.stop) &#123;</div><div class="line">      <span class="keyword">this</span>.value++;</div><div class="line">      <span class="keyword">return</span> &#123;<span class="attr">done</span>: <span class="literal">false</span>, <span class="attr">value</span>: value&#125;;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> &#123;<span class="attr">done</span>: <span class="literal">true</span>, <span class="attr">value</span>: <span class="literal">undefined</span>&#125;;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">range</span>(<span class="params">start, stop</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">new</span> RangeIterator(start, stop);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> value <span class="keyword">of</span> range(<span class="number">0</span>, <span class="number">3</span>)) &#123;</div><div class="line">  <span class="built_in">console</span>.log(value);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 第二种</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Obj</span>(<span class="params">value</span>)</span>&#123;</div><div class="line">  <span class="keyword">this</span>.value = value;</div><div class="line">  <span class="keyword">this</span>.next = <span class="literal">null</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Obj.prototype[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> iterator = &#123;</div><div class="line">    <span class="attr">next</span>: next</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="keyword">var</span> current = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">function</span> <span class="title">next</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span> (current)&#123;</div><div class="line">      <span class="keyword">var</span> value = current.value;</div><div class="line">      <span class="keyword">var</span> done = current === <span class="literal">null</span>;</div><div class="line">      current = current.next;</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">done</span>: done,</div><div class="line">        <span class="attr">value</span>: value</div><div class="line">      &#125;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">done</span>: <span class="literal">true</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> iterator;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> one = <span class="keyword">new</span> Obj(<span class="number">1</span>);</div><div class="line"><span class="keyword">var</span> two = <span class="keyword">new</span> Obj(<span class="number">2</span>);</div><div class="line"><span class="keyword">var</span> three = <span class="keyword">new</span> Obj(<span class="number">3</span>);</div><div class="line"></div><div class="line">one.next = two;</div><div class="line">two.next = three;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">of</span> one)&#123;</div><div class="line">  <span class="built_in">console</span>.log(i)</div><div class="line">&#125;</div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// 2</span></div><div class="line"><span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="comment">// 第三种</span></div><div class="line"><span class="keyword">let</span> obj = &#123;</div><div class="line">  <span class="attr">data</span>: [ <span class="string">'hello'</span>, <span class="string">'world'</span> ],</div><div class="line">  [<span class="built_in">Symbol</span>.iterator]() &#123;</div><div class="line">    <span class="keyword">const</span> self = <span class="keyword">this</span>;</div><div class="line">    <span class="keyword">let</span> index = <span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      next() &#123;</div><div class="line">        <span class="keyword">if</span> (index &lt; self.data.length) &#123;</div><div class="line">          <span class="keyword">return</span> &#123;</div><div class="line">            <span class="attr">value</span>: self.data[index++],</div><div class="line">            <span class="attr">done</span>: <span class="literal">false</span></div><div class="line">          &#125;;</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          <span class="keyword">return</span> &#123; <span class="attr">value</span>: <span class="literal">undefined</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;;</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>上面的三个例子都有一个共同点，就是部署 Iterator 接口都是在对象的 <code>Symbol.iterator</code> 属性中返回一个对象，而该对象包含一个 <code>next()</code> 函数指明指针的运动逻辑，并返回 <code>value</code> 和 <code>done</code> 两个值。还有另外一个 <code>return()</code> 方法用于在中断遍历时的操作，必须返回一个对象。此外，也可以直接使用数组的 Iterator 作为对象的迭代器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> iterable = &#123;</div><div class="line">  <span class="number">0</span>: <span class="string">'a'</span>,</div><div class="line">  <span class="number">1</span>: <span class="string">'b'</span>,</div><div class="line">  <span class="number">2</span>: <span class="string">'c'</span>,</div><div class="line">  <span class="attr">length</span>: <span class="number">3</span>,</div><div class="line">  [<span class="built_in">Symbol</span>.iterator]: <span class="built_in">Array</span>.prototype[<span class="built_in">Symbol</span>.iterator]</div><div class="line">&#125;;</div><div class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> iterable) &#123;</div><div class="line">  <span class="built_in">console</span>.log(item); <span class="comment">// 'a', 'b', 'c'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意，如果 <code>Symbol.iterator</code> 属性返回并不是一个迭代器的标准对象，那么会报错</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line"></div><div class="line">obj[<span class="built_in">Symbol</span>.iterator] = <span class="function"><span class="params">()</span> =&gt;</span> <span class="number">1</span>;</div><div class="line"></div><div class="line">[...obj] <span class="comment">// TypeError: [] is not a function</span></div></pre></td></tr></table></figure>
<h2 id="Iterator-的使用场景"><a href="#Iterator-的使用场景" class="headerlink" title="Iterator 的使用场景"></a>Iterator 的使用场景</h2><h3 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h3><blockquote>
<p>对数组的解构赋值默认会调用 <code>Symbol.iterator</code> 方法</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> set = <span class="keyword">new</span> <span class="built_in">Set</span>().add(<span class="string">'a'</span>).add(<span class="string">'b'</span>).add(<span class="string">'c'</span>);</div><div class="line"></div><div class="line"><span class="keyword">let</span> [x,y] = set;</div><div class="line"><span class="comment">// x='a'; y='b'</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> [first, ...rest] = set;</div><div class="line"><span class="comment">// first='a'; rest=['b','c'];</span></div></pre></td></tr></table></figure>
<h3 id="扩展运算符"><a href="#扩展运算符" class="headerlink" title="扩展运算符"></a>扩展运算符</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'hello'</span>;</div><div class="line">[...str] <span class="comment">//  ['h','e','l','l','o']</span></div><div class="line"></div><div class="line"><span class="comment">// 例二</span></div><div class="line"><span class="keyword">let</span> arr = [<span class="string">'b'</span>, <span class="string">'c'</span>];</div><div class="line">[<span class="string">'a'</span>, ...arr, <span class="string">'d'</span>]</div><div class="line"><span class="comment">// ['a', 'b', 'c', 'd']</span></div></pre></td></tr></table></figure>
<h3 id="yield"><a href="#yield" class="headerlink" title="yield*"></a>yield*</h3><blockquote>
<p>这个还没学到，不予评论，后面学到了再填坑</p>
</blockquote>
<h3 id="其他场景"><a href="#其他场景" class="headerlink" title="其他场景"></a>其他场景</h3><ul>
<li>for…of</li>
<li>Array.from()</li>
<li>Map(), Set(), WeakMap(), WeakSet()（比如new Map([[‘a’,1],[‘b’,2]])）</li>
<li>Promise.all()</li>
<li>Promise.race()</li>
<li>字符串也部署了 Iterator 接口</li>
</ul>
<h1 id="for…of"><a href="#for…of" class="headerlink" title="for…of"></a>for…of</h1><ul>
<li>for…of 遍历数组，key 值保持为数字，而 for…in 会把 key 值变为字符串</li>
<li>for…of 可以 break 或 return，而 forEach() 不可以</li>
<li>for…of 可以正确识别 32 位 UTF-16 字符</li>
</ul>
<blockquote>
<p>以上实例代码大部分来自阮一峰老师的 《ECMAScript 6 入门》 一书<br>书籍在线阅读地址: <a href="http://es6.ruanyifeng.com/#README" target="_blank" rel="external">http://es6.ruanyifeng.com/#README</a></p>
</blockquote>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/23/ES6-学习笔记（六）/" class="archive-article-date">
  	<time datetime="2016-04-23T14:13:41.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-23</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/ECMAScript-6/">ECMAScript 6</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ES6-学习笔记（五）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/21/ES6-学习笔记（五）/">ES6 学习笔记（五）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h1><blockquote>
<p>Set 是一个类数组的数据结构，但是它的值都是独一无二的，并且它是一个构造函数</p>
</blockquote>
<p>Set 有以下几个特点</p>
<ul>
<li>值是不重复的</li>
<li>NaN 等于自身</li>
<li>添加值的时候不会进行类型转换，5 和 ‘5’ 是不一样的</li>
<li>可以接受一组数组进行初始化，会自动过滤重复的数</li>
<li>两个空对象不互相相等</li>
</ul>
<h2 id="Set-的方法"><a href="#Set-的方法" class="headerlink" title="Set 的方法"></a>Set 的方法</h2><ul>
<li>Set.prototype.constructor：构造函数，默认就是Set函数</li>
<li>Set.prototype.size：返回Set实例的成员总数</li>
<li><p>add(value)：添加某个值，返回Set结构本身，由于返回值的特点，可以链式调用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">s.add(<span class="number">1</span>).add(<span class="number">2</span>).add(<span class="number">2</span>);</div></pre></td></tr></table></figure>
</li>
<li><p>delete(value)：删除某个值，返回一个布尔值，表示删除是否成功</p>
</li>
<li>has(value)：返回一个布尔值，表示该值是否为Set的成员</li>
<li>clear()：清除所有成员，没有返回值</li>
<li>keys()：返回一个键名的遍历器</li>
<li>values()：返回一个键值的遍历器</li>
<li>entries()：返回一个键值对的遍历器</li>
<li>forEach()：使用回调函数遍历每个成员</li>
</ul>
<h1 id="WeakSet"><a href="#WeakSet" class="headerlink" title="WeakSet"></a>WeakSet</h1><p>WeakSet 有以下几个特点</p>
<ul>
<li>加入成员只能是对象</li>
<li>成员都是弱引用，即垃圾回收机制不会因其引用对象而保持对象的存在</li>
<li>无法引用成员对象</li>
<li>无法变量成员对象</li>
</ul>
<h2 id="WeakSet-的方法"><a href="#WeakSet-的方法" class="headerlink" title="WeakSet 的方法"></a>WeakSet 的方法</h2><ul>
<li>WeakSet.prototype.add(value)：向WeakSet实例添加一个新成员</li>
<li>WeakSet.prototype.delete(value)：清除WeakSet实例的指定成员</li>
<li>WeakSet.prototype.has(value)：返回一个布尔值，表示某个值是否在WeakSet实例之中</li>
</ul>
<h1 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h1><blockquote>
<p>与对象的 key-value 结构类似的一种集合数据结构，不用的是 Map 可以使用任意一种类型的值作为 key，不会发生自动转换为字符串的情况</p>
</blockquote>
<ul>
<li>size：返回Map结构的成员总数</li>
<li>set(key, value)：设置key所对应的键值，然后返回整个Map结构。如果key已经有值，则键值会被更新，否则就新生成该键</li>
<li>get(key)：读取key对应的键值，如果找不到key，返回undefined</li>
<li>has(key)：返回一个布尔值，表示某个键是否在Map数据结构中</li>
<li>delete(key)：删除某个键，返回true。如果删除失败，返回false</li>
<li>clear()：清除所有成员，没有返回值</li>
</ul>
<h1 id="WeakMap"><a href="#WeakMap" class="headerlink" title="WeakMap"></a>WeakMap</h1><blockquote>
<p>与 WeakSet 的特点类似，不过这个相对于 Map 的数据结构的，只能使用 <code>get()</code>、<code>set()</code>、<code>has()</code>、<code>delete()</code></p>
<p>以上实例代码大部分来自阮一峰老师的 《ECMAScript 6 入门》 一书<br>书籍在线阅读地址: <a href="http://es6.ruanyifeng.com/#README" target="_blank" rel="external">http://es6.ruanyifeng.com/#README</a></p>
</blockquote>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/21/ES6-学习笔记（五）/" class="archive-article-date">
  	<time datetime="2016-04-21T05:57:05.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-21</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/ECMAScript-6/">ECMAScript 6</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
    <article id="post-ES6-学习笔记（四）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/20/ES6-学习笔记（四）/">ES6 学习笔记（四）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="二进制数组"><a href="#二进制数组" class="headerlink" title="二进制数组"></a>二进制数组</h1><blockquote>
<p>二进制数组不是数组，只是类数组，二进制数组用于直接操作内存</p>
</blockquote>
<h2 id="ArrayBuffer-long"><a href="#ArrayBuffer-long" class="headerlink" title="ArrayBuffer(long)"></a>ArrayBuffer(long)</h2><blockquote>
<p><code>ArrayBuffer</code> 用于创建一段连续的内存地址，<code>long</code> 表示内存的长度（字节），但是不可以直接读写，只能通过 <code>视图</code> 读写，例如 <code>TypeArray</code>，<code>ArrayBuffer</code> 每个内存地址默认值都为 0。不同 <code>TypeArray</code> 操作同一组内存会互相影响</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> buf = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">32</span>);</div><div class="line"><span class="keyword">var</span> dataView = <span class="keyword">new</span> <span class="built_in">DataView</span>(buf);</div><div class="line">dataView.getUint8(<span class="number">0</span>) <span class="comment">// 0</span></div><div class="line"></div><div class="line"><span class="comment">// 操作同一组内存</span></div><div class="line"><span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">12</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> x1 = <span class="keyword">new</span> <span class="built_in">Int32Array</span>(buffer);</div><div class="line">x1[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line"><span class="keyword">var</span> x2 = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(buffer);</div><div class="line">x2[<span class="number">0</span>]  = <span class="number">2</span>;</div><div class="line"></div><div class="line">x1[<span class="number">0</span>] <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<h3 id="Array-prototype-byteLength"><a href="#Array-prototype-byteLength" class="headerlink" title="Array.prototype.byteLength"></a>Array.prototype.byteLength</h3><blockquote>
<p>获取分配的内存字节长度</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">32</span>);</div><div class="line">buffer.byteLength</div><div class="line"><span class="comment">// 32</span></div><div class="line"></div><div class="line"><span class="keyword">if</span>(buffer.byteLength) &#123;</div><div class="line">    <span class="comment">// success</span></div><div class="line">&#125;<span class="keyword">else</span> &#123;</div><div class="line">    <span class="comment">// error</span></div><div class="line">    <span class="comment">// 分配的内存空间太大，可能存在没有那么大的内存空间而失败的情况</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Array-prototype-slice-start-end"><a href="#Array-prototype-slice-start-end" class="headerlink" title="Array.prototype.slice(start, end)"></a>Array.prototype.slice(start, end)</h3><blockquote>
<p>生成一段新的内存，拷贝 start 到 end-1 位置的内容到新的内存</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">8</span>);</div><div class="line"><span class="keyword">var</span> newBuffer = buffer.slice(<span class="number">0</span>, <span class="number">3</span>);</div></pre></td></tr></table></figure>
<h3 id="ArrayBuffer-isView-buffer"><a href="#ArrayBuffer-isView-buffer" class="headerlink" title="ArrayBuffer.isView(buffer)"></a>ArrayBuffer.isView(buffer)</h3><blockquote>
<p>判断 buffer 是否是视图的实例化对象，该方法为 ArrayBuffer 的静态方法，直接调用</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">8</span>);</div><div class="line"><span class="built_in">ArrayBuffer</span>.isView(buffer) <span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> v = <span class="keyword">new</span> <span class="built_in">Int32Array</span>(buffer);</div><div class="line"><span class="built_in">ArrayBuffer</span>.isView(v) <span class="comment">// true</span></div></pre></td></tr></table></figure>
<h1 id="TypeArray"><a href="#TypeArray" class="headerlink" title="TypeArray"></a>TypeArray</h1><blockquote>
<p><code>TypeArray</code> 不是一个构造函数，而是一组构造函数，它包含 9 个不同的视图构造函数，都是类数组，都能用下标访问，都有 length 属性</p>
</blockquote>
<ul>
<li>Int8Array：8位有符号整数，长度1个字节。</li>
<li>Uint8Array：8位无符号整数，长度1个字节。</li>
<li>Uint8ClampedArray：8位无符号整数，长度1个字节，溢出处理不同。</li>
<li>Int16Array：16位有符号整数，长度2个字节。</li>
<li>Uint16Array：16位无符号整数，长度2个字节。</li>
<li>Int32Array：32位有符号整数，长度4个字节。</li>
<li>Uint32Array：32位无符号整数，长度4个字节。</li>
<li>Float32Array：32位浮点数，长度4个字节。</li>
<li>Float64Array：64位浮点数，长度8个字节。</li>
</ul>
<h2 id="TypedArray-buffer-byteOffset-length"><a href="#TypedArray-buffer-byteOffset-length" class="headerlink" title="TypedArray(buffer [, byteOffset [, length]])"></a>TypedArray(buffer [, byteOffset [, length]])</h2><blockquote>
<p>TypeArray 的构造函数可以传入三个参数</p>
</blockquote>
<ul>
<li>第一个参数，ArrayBuffer 的实例对象，必选</li>
<li>第二个参数，从 ArrayBuffer 的第 byteOffset 个字节开始读取，默认从 0 开始，注意，如果是 16 位的视图，需要是 2 的倍数，如果是 32 位 的视图，需要是 4 的倍数，以此类推，因为例如是 32 位的视图，那么该视图中 4 个字节为一个下标，为了完整读取内存，必须是每一个下标字节大小的整数倍，可选</li>
<li>第三个参数，读取 ArrayBuffer 的 length 个字节，默认读取到末尾，可选</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建一个8字节的ArrayBuffer</span></div><div class="line"><span class="keyword">var</span> b = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">8</span>);</div><div class="line"></div><div class="line"><span class="comment">// 创建一个指向b的Int32视图，开始于字节0，直到缓冲区的末尾</span></div><div class="line"><span class="keyword">var</span> v1 = <span class="keyword">new</span> <span class="built_in">Int32Array</span>(b);</div><div class="line"></div><div class="line"><span class="comment">// 创建一个指向b的Uint8视图，开始于字节2，直到缓冲区的末尾</span></div><div class="line"><span class="keyword">var</span> v2 = <span class="keyword">new</span> <span class="built_in">Uint8Array</span>(b, <span class="number">2</span>);</div><div class="line"></div><div class="line"><span class="comment">// 创建一个指向b的Int16视图，开始于字节2，长度为2</span></div><div class="line"><span class="keyword">var</span> v3 = <span class="keyword">new</span> <span class="built_in">Int16Array</span>(b, <span class="number">2</span>, <span class="number">2</span>);</div></pre></td></tr></table></figure>
<h2 id="TypeArray-length"><a href="#TypeArray-length" class="headerlink" title="TypeArray(length)"></a>TypeArray(length)</h2><blockquote>
<p>TypeArray 的构造函数还能直接通过分配内存创建视图</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> f64a = <span class="keyword">new</span> <span class="built_in">Float64Array</span>(<span class="number">8</span>);</div><div class="line">f64a[<span class="number">0</span>] = <span class="number">10</span>;</div><div class="line">f64a[<span class="number">1</span>] = <span class="number">20</span>;</div><div class="line">f64a[<span class="number">2</span>] = f64a[<span class="number">0</span>] + f64a[<span class="number">1</span>];</div></pre></td></tr></table></figure>
<h2 id="TypeArray-typedArray"><a href="#TypeArray-typedArray" class="headerlink" title="TypeArray(typedArray)"></a>TypeArray(typedArray)</h2><blockquote>
<p>TypeArray 的构造函数能接受另外一个 TypeArray 的实例作为构造参数，新的实例是开辟了新的内存地址同时复制了相同的值，不会互相影响</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> <span class="built_in">Int8Array</span>([<span class="number">1</span>, <span class="number">1</span>]);</div><div class="line"><span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Int8Array</span>(x);</div><div class="line">x[<span class="number">0</span>] <span class="comment">// 1</span></div><div class="line">y[<span class="number">0</span>] <span class="comment">// 1</span></div><div class="line"></div><div class="line">x[<span class="number">0</span>] = <span class="number">2</span>;</div><div class="line">y[<span class="number">0</span>] <span class="comment">// 1</span></div></pre></td></tr></table></figure>
<h2 id="TypedArray-arrayLikeObject"><a href="#TypedArray-arrayLikeObject" class="headerlink" title="TypedArray(arrayLikeObject)"></a>TypedArray(arrayLikeObject)</h2><blockquote>
<p>TypeArray 的构造函数能接受一个类数组的参数，会开辟一段新的内存实例化视图</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> x = <span class="keyword">new</span> <span class="built_in">Int8Array</span>([<span class="number">1</span>, <span class="number">1</span>]);</div><div class="line"><span class="keyword">var</span> y = <span class="keyword">new</span> <span class="built_in">Int8Array</span>(x.buffer);</div><div class="line">x[<span class="number">0</span>] <span class="comment">// 1</span></div><div class="line">y[<span class="number">0</span>] <span class="comment">// 1</span></div><div class="line"></div><div class="line">x[<span class="number">0</span>] = <span class="number">2</span>;</div><div class="line">y[<span class="number">0</span>] <span class="comment">// 2</span></div></pre></td></tr></table></figure>
<h2 id="数组方法"><a href="#数组方法" class="headerlink" title="数组方法"></a>数组方法</h2><blockquote>
<p>普通数组的方法对 TypeArray 也完全适用</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 缺少 contact 方法</span></div><div class="line">TypedArray.prototype.copyWithin(target, start[, end = <span class="keyword">this</span>.length])</div><div class="line">TypedArray.prototype.entries()</div><div class="line">TypedArray.prototype.every(callbackfn, thisArg?)</div><div class="line">TypedArray.prototype.fill(value, start=<span class="number">0</span>, end=<span class="keyword">this</span>.length)</div><div class="line">TypedArray.prototype.filter(callbackfn, thisArg?)</div><div class="line">TypedArray.prototype.find(predicate, thisArg?)</div><div class="line">TypedArray.prototype.findIndex(predicate, thisArg?)</div><div class="line">TypedArray.prototype.forEach(callbackfn, thisArg?)</div><div class="line">TypedArray.prototype.indexOf(searchElement, fromIndex=<span class="number">0</span>)</div><div class="line">TypedArray.prototype.join(separator)</div><div class="line">TypedArray.prototype.keys()</div><div class="line">TypedArray.prototype.lastIndexOf(searchElement, fromIndex?)</div><div class="line">TypedArray.prototype.map(callbackfn, thisArg?)</div><div class="line">TypedArray.prototype.reduce(callbackfn, initialValue?)</div><div class="line">TypedArray.prototype.reduceRight(callbackfn, initialValue?)</div><div class="line">TypedArray.prototype.reverse()</div><div class="line">TypedArray.prototype.slice(start=<span class="number">0</span>, end=<span class="keyword">this</span>.length)</div><div class="line">TypedArray.prototype.some(callbackfn, thisArg?)</div><div class="line">TypedArray.prototype.sort(comparefn)</div><div class="line">TypedArray.prototype.toLocaleString(reserved1?, reserved2?)</div><div class="line">TypedArray.prototype.toString()</div><div class="line">TypedArray.prototype.values()</div></pre></td></tr></table></figure>
<h2 id="小端字节序"><a href="#小端字节序" class="headerlink" title="小端字节序"></a>小端字节序</h2><blockquote>
<p>如果使用一个 32 位的视图读取并修改一段内存后，再使用一个 16 位的视图读取该段内存缓冲时，其长度应该是 32 位视图的两倍，这时候 16 位视图中的数据存放就会出现一个现象，跟字节排放的规则相关，看示例</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> buffer = <span class="keyword">new</span> <span class="built_in">ArrayBuffer</span>(<span class="number">16</span>);</div><div class="line"><span class="keyword">var</span> int32View = <span class="keyword">new</span> <span class="built_in">Int32Array</span>(buffer);</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; int32View.length; i++) &#123;</div><div class="line">  int32View[i] = i * <span class="number">2</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(int32View); <span class="comment">// [0, 2, 4, 6]</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> int16View = <span class="keyword">new</span> <span class="built_in">Int16Array</span>(buffer);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(int16View); <span class="comment">// [0, 0, 2, 0, 4, 0, 6, 0]</span></div></pre></td></tr></table></figure>
<p>由于 32 位视图是 4 个字节存放一个数据，16 位视图是 2 个字节存放一个数据，那么 16 位视图明显要使用 2 个数据位来存放一个 32 位视图的数据，而之所以 16 位视图都是两个数据位的第一个数据位显示为正确数据，第二个显示为 0，这就涉及现代计算机都采用了小端字节序的规则在内存中存放数据的原因，而 TypeArray 也是采用该种策略。小端字节序简略地说就是从后往前一个字节一个字节地存放数据到内存的每个地址中，更详细的解释可以参考：<a href="http://blog.csdn.net/ce123/article/details/6971544" target="_blank" rel="external">http://blog.csdn.net/ce123/article/details/6971544</a> 小端字节序也导致了 TypeArray 无法正确读取大端字节序的内容</p>
<h2 id="TypeArray-prototype-BYTES-PER-ELEMENT"><a href="#TypeArray-prototype-BYTES-PER-ELEMENT" class="headerlink" title="TypeArray.prototype.BYTES_PER_ELEMENT"></a>TypeArray.prototype.BYTES_PER_ELEMENT</h2><blockquote>
<p>用于输出每一个 TypeArray 类型视图的每一位所占的字节数</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Int8Array</span>.BYTES_PER_ELEMENT <span class="comment">// 1</span></div><div class="line"><span class="built_in">Uint8Array</span>.BYTES_PER_ELEMENT <span class="comment">// 1</span></div><div class="line"><span class="built_in">Int16Array</span>.BYTES_PER_ELEMENT <span class="comment">// 2</span></div><div class="line"><span class="built_in">Uint16Array</span>.BYTES_PER_ELEMENT <span class="comment">// 2</span></div><div class="line"><span class="built_in">Int32Array</span>.BYTES_PER_ELEMENT <span class="comment">// 4</span></div><div class="line"><span class="built_in">Uint32Array</span>.BYTES_PER_ELEMENT <span class="comment">// 4</span></div><div class="line"><span class="built_in">Float32Array</span>.BYTES_PER_ELEMENT <span class="comment">// 4</span></div><div class="line"><span class="built_in">Float64Array</span>.BYTES_PER_ELEMENT <span class="comment">// 8</span></div></pre></td></tr></table></figure>
<h2 id="溢出"><a href="#溢出" class="headerlink" title="溢出"></a>溢出</h2><blockquote>
<p>TypeArray 对于溢出的处理就是直接抛弃溢出的位</p>
</blockquote>
<ul>
<li>正向溢出（overflow）：当输入值大于当前数据类型的最大值，结果等于当前数据类型的最小值加上余值，再减去1</li>
<li>负向溢出（underflow）：当输入值小于当前数据类型的最小值，结果等于当前数据类型的最大值减去余值，再加上1</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> int8 = <span class="keyword">new</span> <span class="built_in">Int8Array</span>(<span class="number">1</span>);</div><div class="line"></div><div class="line">int8[<span class="number">0</span>] = <span class="number">128</span>;</div><div class="line">int8[<span class="number">0</span>] <span class="comment">// -128</span></div><div class="line"></div><div class="line">int8[<span class="number">0</span>] = <span class="number">-129</span>;</div><div class="line">int8[<span class="number">0</span>] <span class="comment">// 127</span></div></pre></td></tr></table></figure>
<h2 id="其他方法"><a href="#其他方法" class="headerlink" title="其他方法"></a>其他方法</h2><ul>
<li>TypedArray.prototype.buffer，返回视图整段内存引用</li>
<li>TypedArray.prototype.byteLength，返回视图的内存字节长度</li>
<li>TypedArray.prototype.byteOffset，返回视图从内存第几个字节开始引用</li>
<li>TypedArray.prototype.length，返回视图的成员长度，与其每个成员占用字节数相关</li>
<li>TypedArray.prototype.set(typeArray[, startIndex])，将一段内存完全复制到另一端内存中</li>
<li>TypedArray.prototype.subarray(startIndex, endIndex)，从一个视图上截取一部分创建为一个新的视图</li>
<li>TypedArray.prototype.slice(index)，从一个视图上截取一段创建一个新的视图，index 可以为负数，表示倒数</li>
<li>TypedArray.of()，将参数创建为一个新的视图</li>
<li>TypedArray.from(arrayLike[, callback])，将 arrayLike 转化为一个相应的可遍历的视图类型，callback 的功能类似于数组的 map 功能</li>
</ul>
<h1 id="DataView"><a href="#DataView" class="headerlink" title="DataView"></a>DataView</h1><blockquote>
<p>DataView 可以自行设置大端字节序或者小端字节序，同时有 8 个获取数据的方法和 8 个设置数据的方法</p>
</blockquote>
<ul>
<li>getInt8：读取1个字节，返回一个8位整数。</li>
<li>getUint8：读取1个字节，返回一个无符号的8位整数。</li>
<li>getInt16：读取2个字节，返回一个16位整数。</li>
<li>getUint16：读取2个字节，返回一个无符号的16位整数。</li>
<li>getInt32：读取4个字节，返回一个32位整数。</li>
<li>getUint32：读取4个字节，返回一个无符号的32位整数。</li>
<li>getFloat32：读取4个字节，返回一个32位浮点数。</li>
<li>getFloat64：读取8个字节，返回一个64位浮点数。</li>
</ul>
<p>这 8 个方法都传入一个正整数表示从第几个字节开始读取，第二个参数为一个布尔值，true 代表使用小端字节序，false 代表使用大端字节序，默认为大端字节序</p>
<ul>
<li>setInt8：写入1个字节的8位整数。</li>
<li>setUint8：写入1个字节的8位无符号整数。</li>
<li>setInt16：写入2个字节的16位整数。</li>
<li>setUint16：写入2个字节的16位无符号整数。</li>
<li>setInt32：写入4个字节的32位整数。</li>
<li>setUint32：写入4个字节的32位无符号整数。</li>
<li>setFloat32：写入4个字节的32位浮点数。</li>
<li>setFloat64：写入8个字节的64位浮点数。</li>
</ul>
<p>这 8 个方法都可以传入三个参数，第一个表示从第几个字节写入数据，第二个表示写入数据的内容，第三个指定大小端字节序</p>
<h1 id="其他一些新特性"><a href="#其他一些新特性" class="headerlink" title="其他一些新特性"></a>其他一些新特性</h1><h2 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h2><blockquote>
<p>AJAX 可以设置 <code>responseType</code> 为 <code>arraybuffer</code> 明确指定响应数据位二进制数据，如果不明确，可以设置为 <code>blod</code></p>
</blockquote>
<h2 id="Canvas"><a href="#Canvas" class="headerlink" title="Canvas"></a>Canvas</h2><blockquote>
<p>Canvas 使用 <code>Uint8ClampedArray</code> 读取二进制像素数据，该 TypeArray 可以自动过滤高位溢出，取值范围始终为 0-255</p>
</blockquote>
<h2 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h2><blockquote>
<p>WebSocket 可以发送二进制数据</p>
</blockquote>
<h2 id="Fetch-API"><a href="#Fetch-API" class="headerlink" title="Fetch API"></a>Fetch API</h2><blockquote>
<p>Fetch API取回的数据，就是 <code>ArrayBuffer</code> 对象</p>
</blockquote>
<h2 id="File-API"><a href="#File-API" class="headerlink" title="File API"></a>File API</h2><blockquote>
<p>File API 可以将文件数据作为二进制的 <code>ArrayBuffer</code> 类型读取处理</p>
<p>以上实例代码大部分来自阮一峰老师的 《ECMAScript 6 入门》 一书<br>书籍在线阅读地址: <a href="http://es6.ruanyifeng.com/#README" target="_blank" rel="external">http://es6.ruanyifeng.com/#README</a></p>
</blockquote>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2016/04/20/ES6-学习笔记（四）/" class="archive-article-date">
  	<time datetime="2016-04-20T01:26:29.000Z" itemprop="datePublished"><i class="icon-clock"></i>2016-04-20</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<i class="icon-price-tags"></i>
	<a class="article-category-link" href="/categories/前端/">前端</a><a class="article-category-link" href="/categories/前端/ECMAScript-6/">ECMAScript 6</a>
	</div>


      <div class="clearfix"></div>
    </div>
  </div>
</article>










  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  


      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Rlilyyy
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/CSS/" style="font-size: 12.5px;">CSS</a> <a href="/tags/Javascript/" style="font-size: 20px;">Javascript</a> <a href="/tags/Oxygen/" style="font-size: 17.5px;">Oxygen</a> <a href="/tags/cookie/" style="font-size: 10px;">cookie</a> <a href="/tags/gulp/" style="font-size: 10px;">gulp</a> <a href="/tags/小技巧/" style="font-size: 10px;">小技巧</a> <a href="/tags/布局/" style="font-size: 15px;">布局</a> <a href="/tags/模块化/" style="font-size: 10px;">模块化</a> <a href="/tags/面试/" style="font-size: 10px;">面试</a>
    			</div>
    	</section>
    

    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">Stay folish&lt;br&gt;&lt;br&gt;Stay hungry</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>